{"version":3,"file":"TransactionProvider.js","sources":["../../../src/transaction/components/TransactionProvider.tsx"],"sourcesContent":["import {\n  createContext,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useState,\n} from 'react';\nimport type { Address } from 'viem';\nimport {\n  useAccount,\n  useConfig,\n  useSwitchChain,\n  useWaitForTransactionReceipt,\n} from 'wagmi';\nimport { waitForTransactionReceipt } from 'wagmi/actions';\nimport { useAnalytics } from '../../core/analytics/hooks/useAnalytics';\nimport {\n  TransactionEvent,\n  TransactionEventType,\n  type TransactionEventData,\n} from '../../core/analytics/types';\nimport { Capabilities } from '../../core/constants';\nimport { useCapabilitiesSafe } from '../../internal/hooks/useCapabilitiesSafe';\nimport { useValue } from '../../internal/hooks/useValue';\nimport { useOnchainKit } from '../../useOnchainKit';\nimport { GENERIC_ERROR_MESSAGE } from '../constants';\nimport { useCallsStatus } from '../hooks/useCallsStatus';\nimport { useSendCall } from '../hooks/useSendCall';\nimport { useSendCalls } from '../hooks/useSendCalls';\nimport { useSendWalletTransactions } from '../hooks/useSendWalletTransactions';\nimport type {\n  LifecycleStatus,\n  TransactionContextType,\n  TransactionProviderProps,\n} from '../types';\nimport { getPaymasterUrl } from '../utils/getPaymasterUrl';\nimport { isUserRejectedRequestError } from '../utils/isUserRejectedRequestError';\n\nconst emptyContext = {} as TransactionContextType;\nexport const TransactionContext =\n  createContext<TransactionContextType>(emptyContext);\n\nexport function useTransactionContext() {\n  const context = useContext(TransactionContext);\n  if (context === emptyContext) {\n    throw new Error(\n      'useTransactionContext must be used within a Transaction component',\n    );\n  }\n  return context;\n}\n\nexport function TransactionProvider({\n  calls,\n  capabilities: transactionCapabilities,\n  chainId,\n  children,\n  isSponsored,\n  onError,\n  onStatus,\n  onSuccess,\n  resetAfter,\n}: TransactionProviderProps) {\n  // Core Hooks\n  const account = useAccount();\n  const config = useConfig();\n  const { config: { paymaster } = { paymaster: undefined } } = useOnchainKit();\n\n  const [errorMessage, setErrorMessage] = useState('');\n  const [errorCode, setErrorCode] = useState('');\n  const [isToastVisible, setIsToastVisible] = useState(false);\n  const [lifecycleStatus, setLifecycleStatus] = useState<LifecycleStatus>({\n    statusName: 'init',\n    statusData: null,\n  }); // Component lifecycle\n  const [transactionId, setTransactionId] = useState('');\n  const [transactionCount, setTransactionCount] = useState<\n    number | undefined\n  >();\n  const [transactionHashList, setTransactionHashList] = useState<Address[]>([]);\n\n  // Retrieve wallet capabilities\n  const walletCapabilities = useCapabilitiesSafe({\n    chainId,\n  });\n\n  const { switchChainAsync } = useSwitchChain();\n\n  // Validate `calls` and `contracts` props\n  if (!calls) {\n    throw new Error(\n      'Transaction: calls must be provided as a prop to the Transaction component.',\n    );\n  }\n\n  // useSendCalls or useSendCall\n  // Used for contract calls with raw calldata.\n  const {\n    status: statusSendCalls,\n    sendCallsAsync,\n    reset: resetSendCalls,\n  } = useSendCalls({\n    setLifecycleStatus,\n    setTransactionId,\n  });\n\n  const {\n    status: statusSendCall,\n    sendCallAsync,\n    data: singleTransactionHash,\n    reset: resetSendCall,\n  } = useSendCall({\n    setLifecycleStatus,\n    transactionHashList,\n  });\n\n  // Transaction Status\n  // For batched, use statusSendCalls\n  // For single, use statusSendCall\n  const transactionStatus = useMemo(() => {\n    if (walletCapabilities[Capabilities.AtomicBatch]?.supported) {\n      return statusSendCalls;\n    }\n    return statusSendCall;\n  }, [statusSendCall, statusSendCalls, walletCapabilities]);\n\n  const capabilities = useMemo(() => {\n    if (isSponsored && paymaster) {\n      return {\n        paymasterService: { url: paymaster },\n        // this needs to be below so devs can override default paymaster\n        // with their personal paymaster in production playgroundd\n        ...transactionCapabilities,\n      };\n    }\n    return transactionCapabilities;\n  }, [isSponsored, paymaster, transactionCapabilities]);\n\n  // useSendWalletTransactions\n  // Used to send transactions based on the transaction type. Can be of type calls or contracts.\n  const sendWalletTransactions = useSendWalletTransactions({\n    capabilities,\n    sendCallAsync,\n    sendCallsAsync,\n    walletCapabilities,\n  });\n\n  const { transactionHash: batchedTransactionHash, status: callStatus } =\n    useCallsStatus({\n      setLifecycleStatus,\n      transactionId,\n    });\n\n  const { data: receipt } = useWaitForTransactionReceipt({\n    hash: singleTransactionHash || batchedTransactionHash,\n  });\n\n  const { sendAnalytics } = useAnalytics();\n\n  const handleAnalytics = useCallback(\n    (\n      event: TransactionEventType,\n      data: TransactionEventData[TransactionEventType],\n    ) => {\n      sendAnalytics(event, data);\n    },\n    [sendAnalytics],\n  );\n\n  // Component lifecycle emitters\n  useEffect(() => {\n    setErrorMessage('');\n    // Error\n    if (lifecycleStatus.statusName === 'error') {\n      setErrorMessage(lifecycleStatus.statusData.message);\n      setErrorCode(lifecycleStatus.statusData.code);\n      onError?.(lifecycleStatus.statusData);\n    }\n    // Transaction Legacy Executed\n    if (lifecycleStatus.statusName === 'transactionLegacyExecuted') {\n      setTransactionHashList(lifecycleStatus.statusData.transactionHashList);\n    }\n    // Success\n    if (lifecycleStatus.statusName === 'success') {\n      onSuccess?.({\n        transactionReceipts: lifecycleStatus.statusData.transactionReceipts,\n      });\n    }\n    // Emit Status\n    onStatus?.(lifecycleStatus);\n  }, [\n    onError,\n    onStatus,\n    onSuccess,\n    lifecycleStatus,\n    lifecycleStatus.statusData, // Keep statusData, so that the effect runs when it changes\n    lifecycleStatus.statusName, // Keep statusName, so that the effect runs when it changes\n  ]);\n\n  // Set transaction pending status when writeContracts or writeContract is pending\n  useEffect(() => {\n    if (transactionStatus === 'pending') {\n      setLifecycleStatus({\n        statusName: 'transactionPending',\n        statusData: null,\n      });\n    }\n  }, [transactionStatus]);\n\n  // Trigger success status when receipt is generated by useWaitForTransactionReceipt\n  useEffect(() => {\n    if (!receipt) {\n      return;\n    }\n    setLifecycleStatus({\n      statusName: 'success',\n      statusData: {\n        transactionReceipts: [receipt],\n      },\n    });\n    if (resetAfter) {\n      // Reset all internal state\n      const timeoutId = setTimeout(() => {\n        setErrorMessage('');\n        setErrorCode('');\n        setIsToastVisible(false);\n        setTransactionId('');\n        setTransactionHashList([]);\n        setTransactionCount(undefined);\n        resetSendCalls();\n        resetSendCall();\n      }, resetAfter);\n\n      return () => clearTimeout(timeoutId);\n    }\n  }, [receipt, resetAfter, resetSendCalls, resetSendCall]);\n\n  const getTransactionLegacyReceipts = useCallback(async () => {\n    const receipts = [];\n    for (const hash of transactionHashList) {\n      try {\n        const txnReceipt = await waitForTransactionReceipt(config, {\n          hash,\n          chainId,\n        });\n        receipts.push(txnReceipt);\n      } catch (err) {\n        console.error(err);\n\n        setLifecycleStatus({\n          statusName: 'error',\n          statusData: {\n            code: 'TmTPc01', // Transaction module TransactionProvider component 01 error\n            error: JSON.stringify(err),\n            message: GENERIC_ERROR_MESSAGE,\n          },\n        });\n        return;\n      }\n    }\n    setLifecycleStatus({\n      statusName: 'success',\n      statusData: {\n        transactionReceipts: receipts,\n      },\n    });\n  }, [chainId, config, transactionHashList]);\n\n  // When all transactions are successful, get the receipts\n  useEffect(() => {\n    if (\n      !calls ||\n      transactionHashList.length !== transactionCount ||\n      transactionCount < 2\n    ) {\n      return;\n    }\n    getTransactionLegacyReceipts();\n  }, [\n    calls,\n    transactionCount,\n    transactionHashList,\n    getTransactionLegacyReceipts,\n  ]);\n\n  const switchChain = useCallback(\n    async (targetChainId: number | undefined) => {\n      if (targetChainId && account.chainId !== targetChainId) {\n        await switchChainAsync({ chainId: targetChainId });\n      }\n    },\n    [account.chainId, switchChainAsync],\n  );\n\n  const buildTransaction = useCallback(async () => {\n    setLifecycleStatus({\n      statusName: 'buildingTransaction',\n      statusData: null,\n    });\n    try {\n      handleAnalytics(TransactionEvent.TransactionInitiated, {\n        address: account.address,\n      });\n      const resolvedTransactions = await (typeof calls === 'function'\n        ? calls()\n        : Promise.resolve(calls));\n      setTransactionCount(resolvedTransactions?.length);\n      return resolvedTransactions;\n    } catch (err) {\n      console.error(err);\n      handleAnalytics(TransactionEvent.TransactionFailure, {\n        error: (err as Error).message,\n        metadata: {\n          code: errorCode,\n        },\n      });\n      setLifecycleStatus({\n        statusName: 'error',\n        statusData: {\n          code: 'TmTPc04', // Transaction module TransactionProvider component 04 error\n          error: JSON.stringify(err),\n          message: 'Error building transactions',\n        },\n      });\n      return undefined;\n    }\n  }, [calls, handleAnalytics, account.address, errorCode]);\n\n  const handleSubmit = useCallback(async () => {\n    setErrorMessage('');\n    setIsToastVisible(true);\n    try {\n      // Switch chain before attempting transactions\n      await switchChain(chainId);\n      const resolvedTransactions = await buildTransaction();\n      await sendWalletTransactions(resolvedTransactions);\n    } catch (err) {\n      const errorMessage = isUserRejectedRequestError(err)\n        ? 'Request denied.'\n        : GENERIC_ERROR_MESSAGE;\n      setLifecycleStatus({\n        statusName: 'error',\n        statusData: {\n          code: 'TmTPc03', // Transaction module TransactionProvider component 03 error\n          error: JSON.stringify(err),\n          message: errorMessage,\n        },\n      });\n    }\n  }, [buildTransaction, chainId, sendWalletTransactions, switchChain]);\n\n  const isLoading =\n    callStatus === 'PENDING' ||\n    lifecycleStatus.statusName === 'buildingTransaction' ||\n    lifecycleStatus.statusName === 'transactionPending' ||\n    (lifecycleStatus.statusName === 'transactionLegacyExecuted' &&\n      transactionCount !==\n        lifecycleStatus?.statusData?.transactionHashList?.length) ||\n    ((!!transactionId || !!singleTransactionHash || !!batchedTransactionHash) &&\n      !receipt);\n\n  const value = useValue({\n    chainId,\n    errorCode,\n    errorMessage,\n    isLoading,\n    isToastVisible,\n    lifecycleStatus,\n    onSubmit: handleSubmit,\n    paymasterUrl: getPaymasterUrl(capabilities),\n    receipt,\n    setIsToastVisible,\n    setLifecycleStatus,\n    setTransactionId,\n    transactions: calls,\n    transactionId,\n    transactionHash: singleTransactionHash || batchedTransactionHash,\n    transactionCount,\n  });\n\n  useEffect(() => {\n    if (!receipt) {\n      return;\n    }\n\n    if (receipt.status === 'success') {\n      handleAnalytics(TransactionEvent.TransactionSuccess, {\n        paymaster: Boolean(isSponsored && paymaster),\n        address: account.address,\n        transactionHash: receipt.transactionHash,\n      });\n    } else {\n      handleAnalytics(TransactionEvent.TransactionFailure, {\n        error: 'Transaction failed',\n        metadata: {\n          code: errorCode,\n        },\n      });\n    }\n  }, [\n    receipt,\n    handleAnalytics,\n    isSponsored,\n    paymaster,\n    account.address,\n    errorCode,\n  ]);\n\n  return (\n    <TransactionContext.Provider value={value}>\n      {children}\n    </TransactionContext.Provider>\n  );\n}\n"],"names":["emptyContext","TransactionContext","createContext","useTransactionContext","context","useContext","Error","TransactionProvider","calls","capabilities","transactionCapabilities","chainId","children","isSponsored","onError","onStatus","onSuccess","resetAfter","account","useAccount","config","useConfig","paymaster","undefined","useOnchainKit","errorMessage","setErrorMessage","useState","errorCode","setErrorCode","isToastVisible","setIsToastVisible","lifecycleStatus","setLifecycleStatus","statusName","statusData","transactionId","setTransactionId","transactionCount","setTransactionCount","transactionHashList","setTransactionHashList","walletCapabilities","useCapabilitiesSafe","switchChainAsync","useSwitchChain","status","statusSendCalls","sendCallsAsync","reset","resetSendCalls","useSendCalls","statusSendCall","sendCallAsync","data","singleTransactionHash","resetSendCall","useSendCall","transactionStatus","useMemo","Capabilities","AtomicBatch","supported","paymasterService","url","sendWalletTransactions","useSendWalletTransactions","transactionHash","batchedTransactionHash","callStatus","useCallsStatus","receipt","useWaitForTransactionReceipt","hash","sendAnalytics","useAnalytics","handleAnalytics","useCallback","event","useEffect","message","code","transactionReceipts","timeoutId","setTimeout","clearTimeout","getTransactionLegacyReceipts","receipts","txnReceipt","waitForTransactionReceipt","push","err","console","error","JSON","stringify","GENERIC_ERROR_MESSAGE","length","switchChain","targetChainId","buildTransaction","TransactionEvent","TransactionInitiated","address","resolvedTransactions","Promise","resolve","TransactionFailure","metadata","handleSubmit","isUserRejectedRequestError","isLoading","value","useValue","onSubmit","paymasterUrl","getPaymasterUrl","transactions","TransactionSuccess","Boolean"],"mappings":"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"}