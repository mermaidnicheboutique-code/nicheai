{"version":3,"file":"OnchainKitProvider.js","sources":["../src/OnchainKitProvider.tsx"],"sourcesContent":["'use client';\nimport { setOnchainKitConfig } from '@/core/OnchainKitConfig';\nimport { useContext, useEffect, useLayoutEffect, useMemo } from 'react';\nimport { DefaultOnchainKitProviders } from './DefaultOnchainKitProviders';\nimport OnchainKitProviderBoundary from './OnchainKitProviderBoundary';\nimport { DEFAULT_PRIVACY_URL, DEFAULT_TERMS_URL } from './core/constants';\nimport { generateUUIDWithInsecureFallback } from './internal/utils/crypto';\nimport { OnchainKitContext } from './useOnchainKit';\nimport { useThemeRoot } from './internal/hooks/useTheme';\nimport { clientMetaManager } from './core/clientMeta/clientMetaManager';\nimport { MiniKitContext } from './minikit/MiniKitProvider';\n\nimport { type ReactNode } from 'react';\nimport { useSessionStorage } from 'usehooks-ts';\nimport type { Chain } from 'wagmi/chains';\nimport type { AppConfig } from './core/types';\nimport type { MiniKitOptions } from './minikit/types';\nimport { MiniKitProvider } from '@/minikit/MiniKitProvider';\nimport { type PublicClient } from 'viem';\n\nexport type OnchainKitProviderReact = {\n  analytics?: boolean;\n  apiKey?: string;\n  chain: Chain;\n  children: ReactNode;\n  config?: AppConfig;\n  sessionId?: string;\n  projectId?: string;\n  rpcUrl?: string;\n  miniKit?: MiniKitOptions;\n  defaultPublicClients?: {\n    [chainId: number]: PublicClient;\n  };\n};\n\n/**\n * Provides the OnchainKit React Context to the app.\n */\nexport function OnchainKitProvider({\n  analytics,\n  apiKey,\n  chain,\n  children,\n  config,\n  projectId,\n  rpcUrl,\n  miniKit = {\n    enabled: false,\n  },\n  defaultPublicClients,\n}: OnchainKitProviderReact) {\n  const [sessionId] = useSessionStorage(\n    'ock-session-id',\n    generateUUIDWithInsecureFallback(),\n  );\n\n  const theme = useThemeRoot({\n    theme: config?.appearance?.theme,\n    mode: config?.appearance?.mode,\n  });\n\n  useLayoutEffect(() => {\n    document.documentElement.setAttribute('data-ock-theme', theme);\n  }, [theme]);\n  const isMiniKit = !!useContext(MiniKitContext)?.__isMiniKit;\n\n  useEffect(() => {\n    if (clientMetaManager.isInitialized()) return;\n    clientMetaManager.init({ isMiniKit });\n  }, [isMiniKit]);\n\n  // eslint-disable-next-line complexity\n  const value = useMemo(() => {\n    const defaultPaymasterUrl = apiKey\n      ? `https://api.developer.coinbase.com/rpc/v1/${chain.name\n          .replace(' ', '-')\n          .toLowerCase()}/${apiKey}`\n      : null;\n    const onchainKitConfig = {\n      apiKey: apiKey ?? null,\n      chain: chain,\n      config: {\n        analytics: analytics ?? true,\n        analyticsUrl: config?.analyticsUrl ?? null,\n        appearance: {\n          name: config?.appearance?.name ?? 'Dapp',\n          logo: config?.appearance?.logo ?? '',\n          mode: config?.appearance?.mode ?? 'auto',\n          theme: config?.appearance?.theme ?? 'default',\n        },\n        paymaster: config?.paymaster || defaultPaymasterUrl,\n        wallet: {\n          display: config?.wallet?.display ?? 'classic',\n          preference: config?.wallet?.preference ?? 'all',\n          termsUrl: config?.wallet?.termsUrl || DEFAULT_TERMS_URL,\n          privacyUrl: config?.wallet?.privacyUrl || DEFAULT_PRIVACY_URL,\n          supportedWallets: {\n            rabby: config?.wallet?.supportedWallets?.rabby ?? false,\n            trust: config?.wallet?.supportedWallets?.trust ?? false,\n            frame: config?.wallet?.supportedWallets?.frame ?? false,\n          },\n        },\n      },\n      projectId: projectId ?? null,\n      rpcUrl: rpcUrl ?? null,\n      sessionId,\n      defaultPublicClients,\n      miniKit,\n    };\n    setOnchainKitConfig(onchainKitConfig);\n    return onchainKitConfig;\n  }, [\n    analytics,\n    apiKey,\n    chain,\n    config,\n    projectId,\n    rpcUrl,\n    sessionId,\n    defaultPublicClients,\n    miniKit,\n  ]);\n\n  return (\n    <OnchainKitContext.Provider value={value}>\n      <DefaultOnchainKitProviders>\n        <MiniKitProvider\n          enabled={miniKit.enabled}\n          notificationProxyUrl={miniKit.notificationProxyUrl}\n        >\n          <OnchainKitProviderBoundary>{children}</OnchainKitProviderBoundary>\n        </MiniKitProvider>\n      </DefaultOnchainKitProviders>\n    </OnchainKitContext.Provider>\n  );\n}\n"],"names":["OnchainKitProvider","analytics","apiKey","chain","children","config","projectId","rpcUrl","miniKit","enabled","defaultPublicClients","sessionId","useSessionStorage","generateUUIDWithInsecureFallback","theme","useThemeRoot","appearance","mode","useLayoutEffect","documentElement","setAttribute","isMiniKit","useContext","MiniKitContext","__isMiniKit","useEffect","clientMetaManager","isInitialized","init","value","useMemo","defaultPaymasterUrl","name","replace","toLowerCase","onchainKitConfig","analyticsUrl","logo","paymaster","wallet","display","preference","termsUrl","DEFAULT_TERMS_URL","privacyUrl","DEFAULT_PRIVACY_URL","supportedWallets","rabby","trust","frame","setOnchainKitConfig","notificationProxyUrl"],"mappings":";;;;;;;;;;;;AAsCO,SAASA,mBAAmB;AAAA,EACjCC;AAAAA,EACAC;AAAAA,EACAC;AAAAA,EACAC;AAAAA,EACAC;AAAAA,EACAC;AAAAA,EACAC;AAAAA,EACAC,UAAU;AAAA,IACRC,SAAS;AAAA,EACX;AAAA,EACAC;AACuB,GAAG;;AAC1B,QAAM,CAACC,SAAS,IAAIC,kBAClB,kBACAC,kCACF;AAEA,QAAMC,QAAQC,aAAa;AAAA,IACzBD,QAAOT,sCAAQW,eAARX,mBAAoBS;AAAAA,IAC3BG,OAAMZ,sCAAQW,eAARX,mBAAoBY;AAAAA,EAAAA,CAC3B;AAEDC,kBAAgB,MAAM;AACXC,aAAAA,gBAAgBC,aAAa,kBAAkBN,KAAK;AAAA,EAAA,GAC5D,CAACA,KAAK,CAAC;AACV,QAAMO,YAAY,CAAC,GAACC,gBAAWC,cAAc,MAAzBD,mBAA4BE;AAEhDC,YAAU,MAAM;AACVC,QAAAA,kBAAkBC,gBAAiB;AACvCD,sBAAkBE,KAAK;AAAA,MAAEP;AAAAA,IAAAA,CAAW;AAAA,EAAA,GACnC,CAACA,SAAS,CAAC;AAGRQ,QAAAA,QAAQC,QAAQ,MAAM;;AAC1B,UAAMC,sBAAsB7B,SACxB,6CAA6CC,MAAM6B,KAChDC,QAAQ,KAAK,GAAG,EAChBC,YAAa,CAAA,IAAIhC,MAAM,KAC1B;AACJ,UAAMiC,mBAAmB;AAAA,MACvBjC,QAAQA,UAAU;AAAA,MAClBC;AAAAA,MACAE,QAAQ;AAAA,QACNJ,WAAWA,aAAa;AAAA,QACxBmC,eAAc/B,iCAAQ+B,iBAAgB;AAAA,QACtCpB,YAAY;AAAA,UACVgB,QAAM3B,MAAAA,iCAAQW,eAARX,gBAAAA,IAAoB2B,SAAQ;AAAA,UAClCK,QAAMhC,MAAAA,iCAAQW,eAARX,gBAAAA,IAAoBgC,SAAQ;AAAA,UAClCpB,QAAMZ,MAAAA,iCAAQW,eAARX,gBAAAA,IAAoBY,SAAQ;AAAA,UAClCH,SAAOT,sCAAQW,eAARX,mBAAoBS,UAAS;AAAA,QACtC;AAAA,QACAwB,YAAWjC,iCAAQiC,cAAaP;AAAAA,QAChCQ,QAAQ;AAAA,UACNC,WAASnC,sCAAQkC,WAARlC,mBAAgBmC,YAAW;AAAA,UACpCC,cAAYpC,sCAAQkC,WAARlC,mBAAgBoC,eAAc;AAAA,UAC1CC,YAAUrC,sCAAQkC,WAARlC,mBAAgBqC,aAAYC;AAAAA,UACtCC,cAAYvC,sCAAQkC,WAARlC,mBAAgBuC,eAAcC;AAAAA,UAC1CC,kBAAkB;AAAA,YAChBC,SAAO1C,4CAAQkC,WAARlC,mBAAgByC,qBAAhBzC,mBAAkC0C,UAAS;AAAA,YAClDC,SAAO3C,4CAAQkC,WAARlC,mBAAgByC,qBAAhBzC,mBAAkC2C,UAAS;AAAA,YAClDC,SAAO5C,4CAAQkC,WAARlC,mBAAgByC,qBAAhBzC,mBAAkC4C,UAAS;AAAA,UAAA;AAAA,QACpD;AAAA,MAEJ;AAAA,MACA3C,WAAWA,aAAa;AAAA,MACxBC,QAAQA,UAAU;AAAA,MAClBI;AAAAA,MACAD;AAAAA,MACAF;AAAAA,IACF;AACA0C,wBAAoBf,gBAAgB;AAC7BA,WAAAA;AAAAA,EACT,GAAG,CACDlC,WACAC,QACAC,OACAE,QACAC,WACAC,QACAI,WACAD,sBACAF,OAAO,CACR;AAGC,SAAA,oBAAC,kBAAkB,UAAlB,EAA2B,OAC1B,UAAC,oBAAA,4BAAA,EACC,8BAAC,iBACC,EAAA,SAASA,QAAQC,SACjB,sBAAsBD,QAAQ2C,sBAE9B,UAAA,oBAAC,8BAA4B/C,SAAS,CAAA,GACxC,GACF,EACF,CAAA;AAEJ;"}