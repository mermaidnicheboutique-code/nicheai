{"version":3,"file":"QuantitySelector.js","sources":["../../../src/internal/components/QuantitySelector.tsx"],"sourcesContent":["import { useCallback, useState } from 'react';\nimport { TextInput } from '@/internal/components/TextInput';\nimport { cn, pressable, prefixClassName } from '@/styles/theme';\n\nexport const DELAY_MS = 200;\n\ntype QuantitySelectorReact = {\n  className?: string;\n  disabled?: boolean;\n  minQuantity?: number;\n  maxQuantity?: number;\n  onChange: (s: string) => void;\n  placeholder: string;\n};\n\nexport function QuantitySelector({\n  className,\n  disabled,\n  minQuantity = 1,\n  maxQuantity = Number.MAX_SAFE_INTEGER,\n  onChange,\n  placeholder,\n}: QuantitySelectorReact) {\n  const [value, setValue] = useState(`${minQuantity}`);\n\n  // allow entering '' to enable backspace + new value, fix empty string on blur\n  const isValidQuantity = useCallback(\n    (v: string) => {\n      if (Number.parseInt(v, 10) < minQuantity) {\n        return false;\n      }\n\n      if (Number.parseInt(v, 10) > maxQuantity) {\n        return false;\n      }\n      // only numbers are valid\n      const regex = /^[0-9]*$/;\n      return regex.test(v);\n    },\n    [maxQuantity, minQuantity],\n  );\n\n  const handleIncrement = useCallback(() => {\n    const next = `${Math.min(maxQuantity, Number.parseInt(value, 10) + 1)}`;\n    setValue(next);\n    onChange(next);\n  }, [onChange, maxQuantity, value]);\n\n  const handleDecrement = useCallback(() => {\n    const next = `${Math.max(minQuantity, Number.parseInt(value, 10) - 1)}`;\n    setValue(next);\n    onChange(next);\n  }, [onChange, minQuantity, value]);\n\n  const handleOnChange = useCallback(\n    (v: string) => {\n      if (v === '') {\n        return;\n      }\n\n      onChange(v);\n    },\n    [onChange],\n  );\n\n  const handleBlur = useCallback(() => {\n    if (value === '') {\n      setValue(minQuantity.toString());\n      onChange(minQuantity.toString());\n    }\n  }, [onChange, minQuantity, value]);\n\n  const classNames = prefixClassName(\n    cn(\n      'h-11 w-11 rounded-lg border',\n      'border-ock-background-active',\n      'text-ock-foreground',\n      'bg-ock-background',\n      disabled && pressable.disabled,\n    ),\n  );\n\n  return (\n    <div\n      className={cn('relative flex items-center gap-1', className)}\n      data-testid=\"ockQuantitySelector\"\n    >\n      <div>\n        <button\n          aria-label=\"decrement\"\n          className={cn(classNames, pressable.default)}\n          data-testid=\"ockQuantitySelector_decrement\"\n          disabled={disabled}\n          onClick={handleDecrement}\n          type=\"button\"\n        >\n          -\n        </button>\n      </div>\n      <TextInput\n        aria-label=\"quantity\"\n        className={cn(\n          classNames,\n          'w-full text-center hover:bg-ock-background-hover focus:bg-transparent',\n        )}\n        delayMs={DELAY_MS}\n        disabled={disabled}\n        inputValidator={isValidQuantity}\n        onBlur={handleBlur}\n        onChange={handleOnChange}\n        placeholder={placeholder}\n        setValue={setValue}\n        value={value}\n      />\n      <div>\n        <button\n          aria-label=\"increment\"\n          className={cn(classNames, pressable.default)}\n          data-testid=\"ockQuantitySelector_increment\"\n          disabled={disabled}\n          onClick={handleIncrement}\n          type=\"button\"\n        >\n          +\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":["DELAY_MS","QuantitySelector","className","disabled","minQuantity","maxQuantity","Number","MAX_SAFE_INTEGER","onChange","placeholder","value","setValue","useState","isValidQuantity","useCallback","v","parseInt","regex","test","handleIncrement","next","Math","min","handleDecrement","max","handleOnChange","handleBlur","toString","classNames","prefixClassName","cn","pressable","default"],"mappings":";;;;AAIO,MAAMA,WAAW;AAWjB,SAASC,iBAAiB;AAAA,EAC/BC;AAAAA,EACAC;AAAAA,EACAC,cAAc;AAAA,EACdC,cAAcC,OAAOC;AAAAA,EACrBC;AAAAA,EACAC;AACqB,GAAG;AACxB,QAAM,CAACC,OAAOC,QAAQ,IAAIC,SAAS,GAAGR,WAAW,EAAE;AAG7CS,QAAAA,kBAAkBC,YACtB,CAACC,MAAc;AACb,QAAIT,OAAOU,SAASD,GAAG,EAAE,IAAIX,aAAa;AACjC,aAAA;AAAA,IAAA;AAGT,QAAIE,OAAOU,SAASD,GAAG,EAAE,IAAIV,aAAa;AACjC,aAAA;AAAA,IAAA;AAGT,UAAMY,QAAQ;AACPA,WAAAA,MAAMC,KAAKH,CAAC;AAAA,EAAA,GAErB,CAACV,aAAaD,WAAW,CAC3B;AAEMe,QAAAA,kBAAkBL,YAAY,MAAM;AAClCM,UAAAA,OAAO,GAAGC,KAAKC,IAAIjB,aAAaC,OAAOU,SAASN,OAAO,EAAE,IAAI,CAAC,CAAC;AACrEC,aAASS,IAAI;AACbZ,aAASY,IAAI;AAAA,EACZ,GAAA,CAACZ,UAAUH,aAAaK,KAAK,CAAC;AAE3Ba,QAAAA,kBAAkBT,YAAY,MAAM;AAClCM,UAAAA,OAAO,GAAGC,KAAKG,IAAIpB,aAAaE,OAAOU,SAASN,OAAO,EAAE,IAAI,CAAC,CAAC;AACrEC,aAASS,IAAI;AACbZ,aAASY,IAAI;AAAA,EACZ,GAAA,CAACZ,UAAUJ,aAAaM,KAAK,CAAC;AAE3Be,QAAAA,iBAAiBX,YACrB,CAACC,MAAc;AACb,QAAIA,MAAM,IAAI;AACZ;AAAA,IAAA;AAGFP,aAASO,CAAC;AAAA,EAAA,GAEZ,CAACP,QAAQ,CACX;AAEMkB,QAAAA,aAAaZ,YAAY,MAAM;AACnC,QAAIJ,UAAU,IAAI;AACPN,eAAAA,YAAYuB,UAAU;AACtBvB,eAAAA,YAAYuB,UAAU;AAAA,IAAA;AAAA,EAEhC,GAAA,CAACnB,UAAUJ,aAAaM,KAAK,CAAC;AAE3BkB,QAAAA,aAAaC,gBACjBC,GACE,+BACA,gCACA,uBACA,qBACA3B,YAAY4B,UAAU5B,QACxB,CACF;AAGE,SAAA,qBAAC,SACC,WAAW2B,GAAuC5B,oDAAAA,SAAS,GAC3D,eAAY,uBAEZ,UAAA;AAAA,IAAA,oBAAC,SACC,UAAC,oBAAA,UAAA,EACC,cAAW,aACX,WAAW4B,GAAGF,YAAYG,UAAUC,OAAO,GAC3C,eAAY,iCACZ,UACA,SAAST,iBACT,MAAK,UAAQ,eAGf,EACF,CAAA;AAAA,IACA,oBAAC,aACC,cAAW,YACX,WAAWO,GACTF,YAAU,uFAEZ,GACA,SAAS5B,UACT,UACA,gBAAgBa,iBAChB,QAAQa,YACR,UAAUD,gBACV,aACA,UACA,OAAa;AAAA,IAEf,oBAAC,SACC,UAAC,oBAAA,UAAA,EACC,cAAW,aACX,WAAWK,GAAGF,YAAYG,UAAUC,OAAO,GAC3C,eAAY,iCACZ,UACA,SAASb,iBACT,MAAK,UAAQ,cAGf,CAAA,EACF,CAAA;AAAA,EAAA,GACF;AAEJ;"}