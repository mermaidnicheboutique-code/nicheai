import { jsxs, jsx } from "react/jsx-runtime";
import { useState, useCallback } from "react";
import { TextInput } from "./TextInput.js";
import { prefixClassName, cn, pressable } from "../../styles/theme.js";
const DELAY_MS = 200;
function QuantitySelector({
  className,
  disabled,
  minQuantity = 1,
  maxQuantity = Number.MAX_SAFE_INTEGER,
  onChange,
  placeholder
}) {
  const [value, setValue] = useState(`${minQuantity}`);
  const isValidQuantity = useCallback((v) => {
    if (Number.parseInt(v, 10) < minQuantity) {
      return false;
    }
    if (Number.parseInt(v, 10) > maxQuantity) {
      return false;
    }
    const regex = /^[0-9]*$/;
    return regex.test(v);
  }, [maxQuantity, minQuantity]);
  const handleIncrement = useCallback(() => {
    const next = `${Math.min(maxQuantity, Number.parseInt(value, 10) + 1)}`;
    setValue(next);
    onChange(next);
  }, [onChange, maxQuantity, value]);
  const handleDecrement = useCallback(() => {
    const next = `${Math.max(minQuantity, Number.parseInt(value, 10) - 1)}`;
    setValue(next);
    onChange(next);
  }, [onChange, minQuantity, value]);
  const handleOnChange = useCallback((v) => {
    if (v === "") {
      return;
    }
    onChange(v);
  }, [onChange]);
  const handleBlur = useCallback(() => {
    if (value === "") {
      setValue(minQuantity.toString());
      onChange(minQuantity.toString());
    }
  }, [onChange, minQuantity, value]);
  const classNames = prefixClassName(cn("h-11 w-11 rounded-lg border", "border-ock-background-active", "text-ock-foreground", "bg-ock-background", disabled && pressable.disabled));
  return /* @__PURE__ */ jsxs("div", { className: cn("ock:relative ock:flex ock:items-center ock:gap-1", className), "data-testid": "ockQuantitySelector", children: [
    /* @__PURE__ */ jsx("div", { children: /* @__PURE__ */ jsx("button", { "aria-label": "decrement", className: cn(classNames, pressable.default), "data-testid": "ockQuantitySelector_decrement", disabled, onClick: handleDecrement, type: "button", children: "-" }) }),
    /* @__PURE__ */ jsx(TextInput, { "aria-label": "quantity", className: cn(classNames, "ock:w-full ock:text-center ock:hover:bg-ock-background-hover ock:focus:bg-transparent"), delayMs: DELAY_MS, disabled, inputValidator: isValidQuantity, onBlur: handleBlur, onChange: handleOnChange, placeholder, setValue, value }),
    /* @__PURE__ */ jsx("div", { children: /* @__PURE__ */ jsx("button", { "aria-label": "increment", className: cn(classNames, pressable.default), "data-testid": "ockQuantitySelector_increment", disabled, onClick: handleIncrement, type: "button", children: "+" }) })
  ] });
}
export {
  DELAY_MS,
  QuantitySelector
};
//# sourceMappingURL=QuantitySelector.js.map
