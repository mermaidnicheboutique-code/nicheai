import { jsxs, jsx } from "react/jsx-runtime";
import { useInputResize } from "../../hooks/useInputResize.js";
import { cn, text } from "../../../styles/theme.js";
import { useRef, useCallback, useEffect } from "react";
import { useAmountInput } from "../../hooks/useAmountInput.js";
import { isValidAmount } from "../../utils/isValidAmount.js";
import { TextInput } from "../TextInput.js";
function AmountInput({
  fiatAmount,
  cryptoAmount,
  asset,
  selectedInputType,
  currency,
  setFiatAmount,
  setCryptoAmount,
  exchangeRate,
  delayMs,
  className,
  textClassName
}) {
  const containerRef = useRef(null);
  const wrapperRef = useRef(null);
  const inputRef = useRef(null);
  const measureRef = useRef(null);
  const labelRef = useRef(null);
  const currencyOrAsset = selectedInputType === "fiat" ? currency : asset;
  const value = selectedInputType === "fiat" ? fiatAmount : cryptoAmount;
  const updateScale = useInputResize(containerRef, wrapperRef, inputRef, measureRef, labelRef);
  const {
    handleChange
  } = useAmountInput({
    setFiatAmount,
    setCryptoAmount,
    selectedInputType,
    exchangeRate
  });
  const handleAmountChange = useCallback((value2) => {
    handleChange(value2, () => {
      if (inputRef.current) {
        inputRef.current.focus();
      }
    });
  }, [handleChange]);
  useEffect(() => {
    updateScale();
  }, [value, updateScale]);
  const selectedInputTypeRef = useRef(selectedInputType);
  useEffect(() => {
    if (selectedInputTypeRef.current !== selectedInputType) {
      selectedInputTypeRef.current = selectedInputType;
      handleFocusInput();
    }
  }, [selectedInputType]);
  const handleFocusInput = () => {
    if (inputRef.current) {
      inputRef.current.focus();
    }
  };
  return /* @__PURE__ */ jsxs("div", { ref: containerRef, "data-testid": "ockAmountInputContainer", className: cn("ock:relative ock:h-24 ock:cursor-text", className), children: [
    /* @__PURE__ */ jsx("div", { className: "ock:absolute ock:inset-x-0 ock:top-6 ock:bottom-4", children: /* @__PURE__ */ jsx("div", { className: "ock:relative ock:flex ock:h-14", children: /* @__PURE__ */ jsxs("div", { ref: wrapperRef, className: "ock:flex ock:flex-shrink-0 ock:items-center", children: [
      /* @__PURE__ */ jsx(TextInput, { className: cn(text.body, "ock:border-none ock:bg-transparent", "ock:text-6xl ock:leading-none ock:outline-none", "ock:[appearance:textfield]", "ock:[&::-webkit-inner-spin-button]:m-0 ock:[&::-webkit-inner-spin-button]:appearance-none", "ock:[&::-webkit-outer-spin-button]:m-0 ock:[&::-webkit-outer-spin-button]:appearance-none", textClassName), value, onChange: handleAmountChange, delayMs, inputValidator: isValidAmount, ref: inputRef, inputMode: "decimal", placeholder: "0" }),
      /* @__PURE__ */ jsx("div", { className: "ock:ml-1", children: /* @__PURE__ */ jsx("span", { className: cn(text.body, "ock:text-ock-foreground-disabled", "ock:flex ock:items-center ock:justify-center ock:bg-transparent", "ock:text-6xl ock:leading-none ock:outline-none", textClassName), "data-testid": "ockCurrencySpan", children: currencyOrAsset }) })
    ] }) }) }),
    /* @__PURE__ */ jsx("span", { "data-testid": "ockHiddenSpan", ref: measureRef, className: cn(text.body, "ock:border-none ock:bg-transparent", "ock:text-6xl ock:leading-none ock:outline-none", "ock:pointer-events-none ock:absolute ock:whitespace-nowrap ock:opacity-0", "ock:left-[-99999px]"), children: value ? `${value}.` : "0." })
  ] });
}
export {
  AmountInput
};
//# sourceMappingURL=AmountInput.js.map
