'use client';
import { jsx, jsxs } from "react/jsx-runtime";
import { Address } from "../../../identity/components/Address.js";
import "../../../identity/components/IdentityProvider.js";
import "viem";
import "viem/chains";
import "viem/ens";
import "../../../identity/constants.js";
import "@tanstack/react-query";
import { useState, useMemo } from "react";
import { cn, text } from "../../../styles/theme.js";
import "../../../core/network/attestations.js";
import "../../../identity/utils/easSupportedChains.js";
import "../../../styles/constants.js";
import "../../../useOnchainKit.js";
import { useAccount } from "wagmi";
import { TextInput } from "../../../internal/components/TextInput.js";
import { isValidAmount } from "../../../internal/utils/isValidAmount.js";
import "../../../token/components/TokenRow.js";
import { TokenSelectDropdown } from "../../../token/components/TokenSelectDropdown.js";
import { useAppchainBridgeContext } from "./AppchainBridgeProvider.js";
function AppchainBridgeInput({
  className,
  delayMs = 50
}) {
  const {
    balance,
    bridgeParams,
    bridgeableTokens,
    to,
    isPriceLoading,
    handleAmountChange,
    setIsAddressModalOpen,
    resetDepositStatus
  } = useAppchainBridgeContext();
  const [currentToken, setCurrentToken] = useState(bridgeableTokens[0]);
  const {
    address
  } = useAccount();
  const insufficientBalance = useMemo(() => {
    return balance && Number(balance) < Number(bridgeParams.amount);
  }, [balance, bridgeParams.amount]);
  const label = useMemo(() => {
    if (insufficientBalance) {
      return "Insufficient funds";
    }
    if (isPriceLoading) {
      return /* @__PURE__ */ jsx("div", { className: "ock:h-4 ock:w-16 ock:animate-pulse ock:rounded ock:bg-gray-200 ock:dark:bg-gray-700" });
    }
    if (bridgeParams.amountUSD === "NaN") {
      return "";
    }
    return `~$${bridgeParams.amountUSD}`;
  }, [insufficientBalance, isPriceLoading, bridgeParams.amountUSD]);
  return /* @__PURE__ */ jsxs("div", { className: cn("ock:bg-ock-secondary", "ock:rounded-ock-default", "ock:box-border ock:flex ock:h-[148px] ock:w-full ock:flex-col ock:items-start ock:p-4", className), "data-testid": "ockBridgeAmountInput_Container", children: [
    /* @__PURE__ */ jsx("div", { className: "ock:flex ock:w-full ock:items-center ock:justify-between", children: /* @__PURE__ */ jsxs("span", { className: cn(text.label2, "ock:text-ock-foreground-muted", "ock:flex ock:items-center ock:gap-1"), children: [
      "Send to",
      " ",
      /* @__PURE__ */ jsx("button", { type: "button", className: cn("ock:cursor-pointer ock:hover:underline ock:focus:outline-none", text.label2), onClick: () => {
        setIsAddressModalOpen(true);
      }, title: bridgeParams.recipient, children: /* @__PURE__ */ jsx(Address, { address: bridgeParams.recipient || "0x0000000000000000000000000000000000000000", hasCopyAddressOnClick: false, className: cn(text.label2, "ock:text-ock-foreground") }) }),
      " ",
      "on ",
      /* @__PURE__ */ jsx("span", { className: "ock:inline-flex ock:h-4 ock:w-4 ock:items-center", children: to.icon })
    ] }) }),
    /* @__PURE__ */ jsxs("div", { className: "ock:flex ock:w-full ock:items-center ock:justify-between", children: [
      /* @__PURE__ */ jsx(TextInput, { className: cn("ock:mr-2 ock:w-full ock:border-[none] ock:bg-transparent ock:font-display ock:text-[2.5rem]", "ock:leading-none ock:outline-none", "ock:text-ock-foreground", insufficientBalance && "ock:text-ock-error"), placeholder: "0.00", delayMs, inputValidator: isValidAmount, onChange: (value) => {
        handleAmountChange({
          amount: value,
          token: currentToken
        });
      }, value: bridgeParams.amount }),
      /* @__PURE__ */ jsx(TokenSelectDropdown, { token: currentToken, options: bridgeableTokens, setToken: (token) => {
        handleAmountChange({
          amount: bridgeParams.amount,
          token
        });
        resetDepositStatus();
        setCurrentToken(token);
      } })
    ] }),
    /* @__PURE__ */ jsxs("div", { className: "ock:mt-4 ock:flex ock:w-full ock:justify-between", children: [
      /* @__PURE__ */ jsx("div", { className: "ock:flex ock:items-center", children: /* @__PURE__ */ jsx("span", { className: cn(text.label2, "ock:text-ock-foreground-muted", insufficientBalance && "ock:text-ock-error"), children: label }) }),
      address && /* @__PURE__ */ jsxs("div", { className: "ock:flex ock:items-center", children: [
        /* @__PURE__ */ jsx("span", { className: cn(text.label2, "ock:text-ock-foreground-muted"), children: `Balance: ${Number(balance).toLocaleString(void 0, {
          maximumFractionDigits: 5,
          minimumFractionDigits: 0
        })}` }),
        /* @__PURE__ */ jsx("button", { type: "button", className: "ock:flex ock:cursor-pointer ock:items-center ock:justify-center ock:px-2 ock:py-1", "data-testid": "ockBridgeAmountInput_MaxButton", onClick: () => {
          handleAmountChange({
            amount: balance,
            token: bridgeParams.token
          });
        }, children: /* @__PURE__ */ jsx("span", { className: cn(text.label1, "ock:text-ock-primary"), children: "Max" }) })
      ] })
    ] })
  ] });
}
export {
  AppchainBridgeInput
};
//# sourceMappingURL=AppchainBridgeInput.js.map
