{"version":3,"file":"AutoConnect.js","sources":["../../../src/minikit/components/AutoConnect.tsx"],"sourcesContent":["'use client';\nimport { PropsWithChildren, useEffect, useRef } from 'react';\nimport { useConnect, useAccount } from 'wagmi';\nimport { useIsInMiniApp } from '../hooks/useIsInMiniApp';\n\nconst FARCASTER_CONNECTOR_TYPES = new Set([\n  'farcasterFrame',\n  'farcasterMiniApp',\n]);\n\n/**\n * Automatically connects to the Farcaster connector if the user is in a Mini App\n */\nexport function AutoConnect({\n  children,\n  enabled = true,\n}: PropsWithChildren<{ enabled?: boolean }>) {\n  const { isConnected, isConnecting } = useAccount();\n  const { connectors, connect } = useConnect();\n  const hasAttemptedConnection = useRef(false);\n  const connector = connectors[0];\n  const { isInMiniApp, isSuccess: isInMiniAppSuccess } = useIsInMiniApp();\n\n  useEffect(() => {\n    if (\n      !enabled ||\n      hasAttemptedConnection.current ||\n      !FARCASTER_CONNECTOR_TYPES.has(connector?.type) ||\n      !isInMiniAppSuccess\n    ) {\n      return;\n    }\n\n    hasAttemptedConnection.current = true;\n\n    async function handleAutoConnect() {\n      if (!isInMiniApp || isConnected || isConnecting) return;\n\n      connect({ connector });\n    }\n\n    handleAutoConnect();\n  }, [\n    connectors,\n    connect,\n    isConnected,\n    isConnecting,\n    connector,\n    enabled,\n    isInMiniAppSuccess,\n    isInMiniApp,\n  ]);\n\n  return <>{children}</>;\n}\n"],"names":["FARCASTER_CONNECTOR_TYPES","Set","AutoConnect","children","enabled","isConnected","isConnecting","useAccount","connectors","connect","useConnect","hasAttemptedConnection","useRef","connector","isInMiniApp","isSuccess","isInMiniAppSuccess","useIsInMiniApp","useEffect","current","has","type","handleAutoConnect"],"mappings":";;;;AAKA,MAAMA,4BAAgCC,oBAAAA,IAAI,CACxC,kBACA,kBAAkB,CACnB;AAKM,SAASC,YAAY;AAAA,EAC1BC;AAAAA,EACAC,UAAU;AAC8B,GAAG;AACrC,QAAA;AAAA,IAAEC;AAAAA,IAAaC;AAAAA,MAAiBC,WAAW;AAC3C,QAAA;AAAA,IAAEC;AAAAA,IAAYC;AAAAA,MAAYC,WAAW;AACrCC,QAAAA,yBAAyBC,OAAO,KAAK;AACrCC,QAAAA,YAAYL,WAAW,CAAC;AACxB,QAAA;AAAA,IAAEM;AAAAA,IAAaC,WAAWC;AAAAA,MAAuBC,eAAe;AAEtEC,YAAU,MAAM;AAEZ,QAAA,CAACd,WACDO,uBAAuBQ,WACvB,CAACnB,0BAA0BoB,IAAIP,uCAAWQ,IAAI,KAC9C,CAACL,oBACD;AACA;AAAA,IAAA;AAGFL,2BAAuBQ,UAAU;AAEjC,mBAAeG,oBAAoB;AAC7B,UAAA,CAACR,eAAeT,eAAeC,aAAc;AAEzC,cAAA;AAAA,QAAEO;AAAAA,MAAAA,CAAW;AAAA,IAAA;AAGL,sBAAA;AAAA,EAAA,GACjB,CACDL,YACAC,SACAJ,aACAC,cACAO,WACAT,SACAY,oBACAF,WAAW,CACZ;AAED,yCAAUX,UAAS;AACrB;"}