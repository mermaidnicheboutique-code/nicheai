{"version":3,"file":"CheckoutButton.js","sources":["../../../src/checkout/components/CheckoutButton.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useMemo } from 'react';\nimport { useAnalytics } from '../../core/analytics/hooks/useAnalytics';\nimport { CheckoutEvent } from '../../core/analytics/types';\nimport { Spinner } from '../../internal/components/Spinner';\nimport { useIcon } from '../../internal/hooks/useIcon';\nimport { cn, pressable, text as styleText } from '../../styles/theme';\nimport type { CheckoutButtonProps } from '../types';\nimport { useCheckoutContext } from './CheckoutProvider';\nimport { CHECKOUT_LIFECYCLE_STATUS } from '../constants';\n\n/**\n * @deprecated The <Checkout /> component and its related components and hooks are deprecated\n * and will be removed in a future version. We recommend looking at Base Pay for similar functionality.\n * @see {@link https://docs.base.org/base-account/guides/accept-payments}\n */\nexport function CheckoutButton({\n  className,\n  coinbaseBranded,\n  disabled,\n  icon,\n  text = 'Pay',\n}: CheckoutButtonProps) {\n  if (coinbaseBranded) {\n    icon = 'coinbasePay';\n    text = 'Pay';\n  }\n  const { lifecycleStatus, onSubmit } = useCheckoutContext();\n  const iconSvg = useIcon({ icon });\n  const { sendAnalytics } = useAnalytics();\n\n  const isLoading =\n    lifecycleStatus?.statusName === CHECKOUT_LIFECYCLE_STATUS.PENDING;\n  const isFetchingData =\n    lifecycleStatus?.statusName === CHECKOUT_LIFECYCLE_STATUS.FETCHING_DATA;\n  const isDisabled = disabled || isLoading || isFetchingData;\n\n  const buttonText = useMemo(() => {\n    if (lifecycleStatus?.statusName === CHECKOUT_LIFECYCLE_STATUS.SUCCESS) {\n      return 'View payment details';\n    }\n    return text;\n  }, [lifecycleStatus?.statusName, text]);\n\n  const shouldRenderIcon = buttonText === text && iconSvg;\n\n  useEffect(() => {\n    if (\n      lifecycleStatus?.statusName === CHECKOUT_LIFECYCLE_STATUS.SUCCESS &&\n      lifecycleStatus.statusData\n    ) {\n      const { transactionReceipts, chargeId } = lifecycleStatus.statusData;\n      const transactionHash = transactionReceipts?.[0]?.transactionHash;\n\n      if (transactionHash && chargeId) {\n        sendAnalytics(CheckoutEvent.CheckoutSuccess, {\n          chargeHandlerId: chargeId,\n          transactionHash,\n        });\n      }\n    }\n  }, [lifecycleStatus, sendAnalytics]);\n\n  return (\n    <button\n      className={cn(\n        coinbaseBranded ? pressable.coinbaseBranding : pressable.primary,\n        'rounded-ock-default',\n        isDisabled && pressable.disabled,\n        styleText.headline,\n        'mt-4 w-full px-4 py-3',\n        className,\n      )}\n      onClick={onSubmit}\n      type=\"button\"\n      disabled={isDisabled}\n      aria-label={isLoading ? 'Transaction in progress' : buttonText}\n    >\n      <div className=\"flex items-center justify-center whitespace-nowrap\">\n        {isLoading ? (\n          <Spinner className=\"h-5 w-5\" />\n        ) : (\n          <>\n            {shouldRenderIcon && (\n              <div className=\"mr-2 flex h-5 w-5 shrink-0 items-center justify-center\">\n                {iconSvg}\n              </div>\n            )}\n            <span\n              className={cn(\n                styleText.headline,\n                coinbaseBranded\n                  ? 'text-gray-50'\n                  : 'text-ock-foreground-inverse',\n              )}\n            >\n              {buttonText}\n            </span>\n          </>\n        )}\n      </div>\n    </button>\n  );\n}\n"],"names":["CheckoutButton","className","coinbaseBranded","disabled","icon","text","lifecycleStatus","onSubmit","useCheckoutContext","iconSvg","useIcon","sendAnalytics","useAnalytics","isLoading","statusName","CHECKOUT_LIFECYCLE_STATUS","PENDING","isFetchingData","FETCHING_DATA","isDisabled","buttonText","useMemo","SUCCESS","shouldRenderIcon","useEffect","statusData","transactionReceipts","chargeId","transactionHash","CheckoutEvent","CheckoutSuccess","chargeHandlerId","cn","pressable","coinbaseBranding","primary","styleText","headline"],"mappings":";;;;;;;;;AAiBO,SAASA,eAAe;AAAA,EAC7BC;AAAAA,EACAC;AAAAA,EACAC;AAAAA,EACAC;AAAAA,EAAAA,MACAC,SAAO;AACY,GAAG;AACtB,MAAIH,iBAAiB;AACZ,WAAA;AACAG,aAAA;AAAA,EAAA;AAEH,QAAA;AAAA,IAAEC;AAAAA,IAAiBC;AAAAA,MAAaC,mBAAmB;AACzD,QAAMC,UAAUC,QAAQ;AAAA,IAAEN;AAAAA,EAAAA,CAAM;AAC1B,QAAA;AAAA,IAAEO;AAAAA,MAAkBC,aAAa;AAEjCC,QAAAA,aACJP,mDAAiBQ,gBAAeC,0BAA0BC;AACtDC,QAAAA,kBACJX,mDAAiBQ,gBAAeC,0BAA0BG;AACtDC,QAAAA,aAAahB,YAAYU,aAAaI;AAEtCG,QAAAA,aAAaC,QAAQ,MAAM;AAC3Bf,SAAAA,mDAAiBQ,gBAAeC,0BAA0BO,SAAS;AAC9D,aAAA;AAAA,IAAA;AAEFjB,WAAAA;AAAAA,EACN,GAAA,CAACC,mDAAiBQ,YAAYT,MAAI,CAAC;AAEhCkB,QAAAA,mBAAmBH,eAAef,UAAQI;AAEhDe,YAAU,MAAM;;AACd,SACElB,mDAAiBQ,gBAAeC,0BAA0BO,WAC1DhB,gBAAgBmB,YAChB;AACM,YAAA;AAAA,QAAEC;AAAAA,QAAqBC;AAAAA,UAAarB,gBAAgBmB;AACpDG,YAAAA,mBAAkBF,gEAAsB,OAAtBA,mBAA0BE;AAElD,UAAIA,mBAAmBD,UAAU;AAC/BhB,sBAAckB,cAAcC,iBAAiB;AAAA,UAC3CC,iBAAiBJ;AAAAA,UACjBC;AAAAA,QAAAA,CACD;AAAA,MAAA;AAAA,IACH;AAAA,EACF,GACC,CAACtB,iBAAiBK,aAAa,CAAC;AAEnC,6BACG,UACC,EAAA,WAAWqB,GACT9B,kBAAkB+B,UAAUC,mBAAmBD,UAAUE,SAAO,2BAEhEhB,cAAcc,UAAU9B,UACxBiC,KAAUC,UAAQ,yCAElBpC,SACF,GACA,SAASM,UACT,MAAK,UACL,UAAUY,YACV,cAAYN,YAAY,4BAA4BO,YAEpD,UAAA,oBAAC,OAAI,EAAA,WAAU,sEACZP,UACC,YAAA,oBAAC,WAAQ,WAAU,kBAAS,CAAA,IAGzBU,qBAAAA,UAAAA,EAAAA,UAAAA;AAAAA,IAAAA,oBACE,oBAAA,OAAA,EAAI,WAAU,sFACZd,UACH,SAAA;AAAA,IAEF,oBAAC,QACC,EAAA,WAAWuB,GACTI,KAAUC,UACVnC,kBAAe,qBAAA,iCAGjB,GAECkB,UACH,WAAA,CAAA;AAAA,EAAA,EACF,CAAA,EAEJ,CAAA,GACF;AAEJ;"}