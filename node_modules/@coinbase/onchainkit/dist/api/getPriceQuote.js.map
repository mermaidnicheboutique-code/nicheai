{"version":3,"file":"getPriceQuote.js","sources":["../../src/api/getPriceQuote.ts"],"sourcesContent":["import { RequestContext, RequestContextType } from '@/core/network/constants';\nimport { CDP_GET_PRICE_QUOTE } from '@/core/network/definitions/wallet';\nimport { sendRequest } from '@/core/network/request';\n\nimport type { GetPriceQuoteParams, GetPriceQuoteResponse } from './types';\nimport { buildErrorStruct } from './utils/buildErrorStruct';\nimport { ApiErrorCode } from './constants';\n\n/**\n * Retrieves a price quote for a token\n *\n * @param params - The parameters for the price quote. The property `tokens`\n * must be an array of contract addresses or 'ETH'.\n * @param _context - The context in which the price quote is retrieved\n * @returns The price quote for the token\n */\nexport async function getPriceQuote(\n  params: GetPriceQuoteParams,\n  _context: RequestContextType = RequestContext.API,\n): Promise<GetPriceQuoteResponse> {\n  const apiParams = validateGetPriceQuoteParams(params);\n  if ('error' in apiParams) {\n    return apiParams;\n  }\n\n  try {\n    const res = await sendRequest<GetPriceQuoteParams, GetPriceQuoteResponse>(\n      CDP_GET_PRICE_QUOTE,\n      [apiParams],\n      _context,\n    );\n    if (res.error) {\n      return buildErrorStruct({\n        code: String(res.error.code),\n        error: 'Error fetching price quote',\n        message: res.error.message,\n      });\n    }\n    return res.result;\n  } catch (error) {\n    return buildErrorStruct({\n      code: ApiErrorCode.UncaughtPriceQuoteError,\n      error: 'Something went wrong',\n      message: `Error fetching price quote: ${error}`,\n    });\n  }\n}\n\nfunction validateGetPriceQuoteParams(params: GetPriceQuoteParams) {\n  const { tokens } = params;\n\n  if (!tokens || tokens.length === 0) {\n    return buildErrorStruct({\n      code: ApiErrorCode.InvalidInput,\n      error: 'Invalid input: tokens must be an array of at least one token',\n      message: 'Tokens must be an array of at least one token',\n    });\n  }\n\n  return params;\n}\n"],"names":["getPriceQuote","params","_context","RequestContext","API","apiParams","validateGetPriceQuoteParams","res","sendRequest","CDP_GET_PRICE_QUOTE","error","buildErrorStruct","code","String","message","result","ApiErrorCode","UncaughtPriceQuoteError","tokens","length","InvalidInput"],"mappings":";;;;;AAgBA,eAAsBA,cACpBC,QACAC,WAA+BC,eAAeC,KACd;AAC1BC,QAAAA,YAAYC,4BAA4BL,MAAM;AACpD,MAAI,WAAWI,WAAW;AACjBA,WAAAA;AAAAA,EAAAA;AAGL,MAAA;AACF,UAAME,MAAM,MAAMC,YAChBC,qBACA,CAACJ,SAAS,GACVH,QACF;AACA,QAAIK,IAAIG,OAAO;AACb,aAAOC,iBAAiB;AAAA,QACtBC,MAAMC,OAAON,IAAIG,MAAME,IAAI;AAAA,QAC3BF,OAAO;AAAA,QACPI,SAASP,IAAIG,MAAMI;AAAAA,MAAAA,CACpB;AAAA,IAAA;AAEH,WAAOP,IAAIQ;AAAAA,WACJL,OAAO;AACd,WAAOC,iBAAiB;AAAA,MACtBC,MAAMI,aAAaC;AAAAA,MACnBP,OAAO;AAAA,MACPI,SAAS,+BAA+BJ,KAAK;AAAA,IAAA,CAC9C;AAAA,EAAA;AAEL;AAEA,SAASJ,4BAA4BL,QAA6B;AAC1D,QAAA;AAAA,IAAEiB;AAAAA,EAAAA,IAAWjB;AAEnB,MAAI,CAACiB,UAAUA,OAAOC,WAAW,GAAG;AAClC,WAAOR,iBAAiB;AAAA,MACtBC,MAAMI,aAAaI;AAAAA,MACnBV,OAAO;AAAA,MACPI,SAAS;AAAA,IAAA,CACV;AAAA,EAAA;AAGIb,SAAAA;AACT;"}