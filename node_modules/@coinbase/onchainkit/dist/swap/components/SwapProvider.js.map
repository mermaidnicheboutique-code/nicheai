{"version":3,"file":"SwapProvider.js","sources":["../../../src/swap/components/SwapProvider.tsx"],"sourcesContent":["import { RequestContext } from '@/core/network/constants';\nimport {\n  createContext,\n  useCallback,\n  useContext,\n  useEffect,\n  useState,\n} from 'react';\nimport { base } from 'viem/chains';\nimport { useAccount, useConfig, useSendTransaction } from 'wagmi';\nimport { useSwitchChain } from 'wagmi';\nimport { useSendCalls } from 'wagmi/experimental';\nimport { buildSwapTransaction } from '@/api/buildSwapTransaction';\nimport { getSwapQuote } from '@/api/getSwapQuote';\nimport { useAnalytics } from '@/core/analytics/hooks/useAnalytics';\nimport { SwapEvent } from '@/core/analytics/types';\nimport { useCapabilitiesSafe } from '@/internal/hooks/useCapabilitiesSafe';\nimport { useLifecycleStatus } from '@/internal/hooks/useLifecycleStatus';\nimport { useValue } from '@/internal/hooks/useValue';\nimport { formatTokenAmount } from '@/internal/utils/formatTokenAmount';\nimport type { Token } from '@/token';\nimport { GENERIC_ERROR_MESSAGE } from '@/transaction/constants';\nimport { isUserRejectedRequestError } from '@/transaction/utils/isUserRejectedRequestError';\nimport { useOnchainKit } from '@/useOnchainKit';\nimport { FALLBACK_DEFAULT_MAX_SLIPPAGE } from '../constants';\nimport { useAwaitCalls } from '../hooks/useAwaitCalls';\nimport { useFromTo } from '../hooks/useFromTo';\nimport { useResetInputs } from '../hooks/useResetInputs';\nimport type {\n  LifecycleStatus,\n  SwapContextType,\n  SwapProviderProps,\n} from '../types';\nimport { isSwapError } from '../utils/isSwapError';\nimport { processSwapTransaction } from '../utils/processSwapTransaction';\n\nconst emptyContext = {} as SwapContextType;\n\nexport const SwapContext = createContext<SwapContextType>(emptyContext);\n\nexport function useSwapContext() {\n  const context = useContext(SwapContext);\n  if (context === emptyContext) {\n    throw new Error('useSwapContext must be used within a Swap component');\n  }\n  return context;\n}\n\nexport function SwapProvider({\n  children,\n  config = {\n    maxSlippage: FALLBACK_DEFAULT_MAX_SLIPPAGE,\n  },\n  experimental,\n  isSponsored,\n  onError,\n  onStatus,\n  onSuccess,\n}: SwapProviderProps) {\n  const { config: { paymaster } = { paymaster: undefined } } = useOnchainKit();\n  const { address, chainId } = useAccount();\n  const { switchChainAsync } = useSwitchChain();\n  // Feature flags\n  const { useAggregator } = experimental;\n  // Core Hooks\n  const accountConfig = useConfig();\n\n  const walletCapabilities = useCapabilitiesSafe({\n    chainId: base.id,\n  }); // Swap is only available on Base\n  const [lifecycleStatus, updateLifecycleStatus] =\n    useLifecycleStatus<LifecycleStatus>({\n      statusName: 'init',\n      statusData: {\n        isMissingRequiredField: true,\n        maxSlippage: config.maxSlippage,\n      },\n    }); // Component lifecycle\n\n  const [isToastVisible, setIsToastVisible] = useState(false);\n  const [transactionHash, setTransactionHash] = useState('');\n  const [hasHandledSuccess, setHasHandledSuccess] = useState(false);\n  const { from, to } = useFromTo(address);\n  const { sendTransactionAsync } = useSendTransaction(); // Sending the transaction (and approval, if applicable)\n  const { sendCallsAsync } = useSendCalls(); // Atomic Batch transactions (and approval, if applicable)\n\n  // Refreshes balances and inputs post-swap\n  const resetInputs = useResetInputs({ from, to });\n  // For batched transactions, listens to and awaits calls from the Wallet server\n  const awaitCallsStatus = useAwaitCalls({\n    accountConfig,\n    lifecycleStatus,\n    updateLifecycleStatus,\n  });\n\n  const { sendAnalytics } = useAnalytics();\n\n  // Component lifecycle emitters\n  useEffect(() => {\n    // Error\n    if (lifecycleStatus.statusName === 'error') {\n      onError?.(lifecycleStatus.statusData);\n      sendAnalytics(SwapEvent.SwapFailure, {\n        error: lifecycleStatus.statusData.error,\n        metadata: lifecycleStatus.statusData,\n      });\n    }\n    // Success\n    if (lifecycleStatus.statusName === 'success') {\n      onSuccess?.(lifecycleStatus.statusData.transactionReceipt);\n      setTransactionHash(\n        lifecycleStatus.statusData?.transactionReceipt.transactionHash,\n      );\n      setHasHandledSuccess(true);\n      setIsToastVisible(true);\n      sendAnalytics(SwapEvent.SwapSuccess, {\n        paymaster: !!paymaster,\n        transactionHash:\n          lifecycleStatus.statusData.transactionReceipt?.transactionHash,\n        address: address || '',\n        amount: Number(from.amount),\n        from: from.token?.symbol || '',\n        to: to.token?.symbol || '',\n      });\n    }\n    // Emit Status\n    onStatus?.(lifecycleStatus);\n  }, [\n    onError,\n    onStatus,\n    onSuccess,\n    lifecycleStatus,\n    lifecycleStatus.statusData, // Keep statusData, so that the effect runs when it changes\n    lifecycleStatus.statusName, // Keep statusName, so that the effect runs when it changes\n    sendAnalytics,\n    paymaster,\n    from.amount,\n    from.token?.symbol,\n    to.token?.symbol,\n    address,\n  ]);\n\n  useEffect(() => {\n    // Reset inputs after status reset. `resetInputs` is dependent\n    // on 'from' and 'to' so moved to separate useEffect to\n    // prevents multiple calls to `onStatus`\n    if (lifecycleStatus.statusName === 'init' && hasHandledSuccess) {\n      setHasHandledSuccess(false);\n      resetInputs();\n    }\n  }, [hasHandledSuccess, lifecycleStatus.statusName, resetInputs]);\n\n  useEffect(() => {\n    // For batched transactions, `transactionApproved` will contain the calls ID\n    // We'll use the `useAwaitCalls` hook to listen to the call status from the wallet server\n    // This will update the lifecycle status to `success` once the calls are confirmed\n    if (\n      lifecycleStatus.statusName === 'transactionApproved' &&\n      lifecycleStatus.statusData.transactionType === 'Batched'\n    ) {\n      awaitCallsStatus();\n    }\n  }, [\n    awaitCallsStatus,\n    lifecycleStatus,\n    lifecycleStatus.statusData,\n    lifecycleStatus.statusName,\n  ]);\n\n  useEffect(() => {\n    // Reset status to init after success has been handled\n    if (lifecycleStatus.statusName === 'success' && hasHandledSuccess) {\n      updateLifecycleStatus({\n        statusName: 'init',\n        statusData: {\n          isMissingRequiredField: true,\n          maxSlippage: config.maxSlippage,\n        },\n      });\n    }\n  }, [\n    config.maxSlippage,\n    hasHandledSuccess,\n    lifecycleStatus.statusName,\n    updateLifecycleStatus,\n  ]);\n\n  const handleToggle = useCallback(() => {\n    from.setAmount(to.amount);\n    to.setAmount(from.amount);\n    from.setToken?.(to.token);\n    to.setToken?.(from.token);\n\n    updateLifecycleStatus({\n      statusName: 'amountChange',\n      statusData: {\n        amountFrom: from.amount,\n        amountTo: to.amount,\n        tokenFrom: from.token,\n        tokenTo: to.token,\n        // token is missing\n        isMissingRequiredField:\n          !from.token || !to.token || !from.amount || !to.amount,\n      },\n    });\n  }, [from, to, updateLifecycleStatus]);\n\n  const handleAmountChange = useCallback(\n    async (\n      type: 'from' | 'to',\n      amount: string,\n      sToken?: Token,\n      dToken?: Token,\n    ) => {\n      const source = type === 'from' ? from : to;\n      const destination = type === 'from' ? to : from;\n\n      source.token = sToken ?? source.token;\n      destination.token = dToken ?? destination.token;\n\n      // if token is missing alert user via isMissingRequiredField\n      if (source.token === undefined || destination.token === undefined) {\n        updateLifecycleStatus({\n          statusName: 'amountChange',\n          statusData: {\n            amountFrom: from.amount,\n            amountTo: to.amount,\n            tokenFrom: from.token,\n            tokenTo: to.token,\n            // token is missing\n            isMissingRequiredField: true,\n          },\n        });\n        return;\n      }\n      if (amount === '' || amount === '.' || Number.parseFloat(amount) === 0) {\n        destination.setAmount('');\n        destination.setAmountUSD('');\n        source.setAmountUSD('');\n        return;\n      }\n\n      // When toAmount changes we fetch quote for fromAmount\n      // so set isFromQuoteLoading to true\n      destination.setLoading(true);\n      updateLifecycleStatus({\n        statusName: 'amountChange',\n        statusData: {\n          // when fetching quote, the previous\n          // amount is irrelevant\n          amountFrom: type === 'from' ? amount : '',\n          amountTo: type === 'to' ? amount : '',\n          tokenFrom: from.token,\n          tokenTo: to.token,\n          // when fetching quote, the destination\n          // amount is missing\n          isMissingRequiredField: true,\n        },\n      });\n\n      try {\n        const maxSlippage = lifecycleStatus.statusData.maxSlippage;\n        const response = await getSwapQuote(\n          {\n            amount,\n            amountReference: 'from',\n            from: source.token,\n            maxSlippage: String(maxSlippage),\n            to: destination.token,\n            useAggregator,\n          },\n          RequestContext.Swap,\n        );\n        // If request resolves to error response set the quoteError\n        // property of error state to the SwapError response\n        if (isSwapError(response)) {\n          updateLifecycleStatus({\n            statusName: 'error',\n            statusData: {\n              code: response.code,\n              error: response.error,\n              message: '',\n            },\n          });\n          return;\n        }\n        const formattedAmount = formatTokenAmount(\n          response.toAmount,\n          response.to.decimals,\n        );\n        destination.setAmountUSD(response.toAmountUSD);\n        destination.setAmount(formattedAmount);\n        source.setAmountUSD(response.fromAmountUSD);\n        updateLifecycleStatus({\n          statusName: 'amountChange',\n          statusData: {\n            amountFrom: type === 'from' ? amount : formattedAmount,\n            amountTo: type === 'to' ? amount : formattedAmount,\n            tokenFrom: from.token,\n            tokenTo: to.token,\n            // if quote was fetched successfully, we\n            // have all required fields\n            isMissingRequiredField: !formattedAmount,\n          },\n        });\n      } catch (err) {\n        updateLifecycleStatus({\n          statusName: 'error',\n          statusData: {\n            code: 'TmSPc01', // Transaction module SwapProvider component 01 error\n            error: JSON.stringify(err),\n            message: '',\n          },\n        });\n      } finally {\n        // reset loading state when quote request resolves\n        destination.setLoading(false);\n      }\n    },\n    [from, to, lifecycleStatus, updateLifecycleStatus, useAggregator],\n  );\n\n  const handleSubmit = useCallback(async () => {\n    if (!address || !from.token || !to.token || !from.amount) {\n      return;\n    }\n\n    try {\n      sendAnalytics(SwapEvent.SwapInitiated, {\n        amount: Number(from.amount),\n      });\n\n      const maxSlippage = lifecycleStatus.statusData.maxSlippage;\n      const response = await buildSwapTransaction(\n        {\n          amount: from.amount,\n          fromAddress: address,\n          from: from.token,\n          maxSlippage: String(maxSlippage),\n          to: to.token,\n          useAggregator,\n        },\n        RequestContext.Swap,\n      );\n      if (isSwapError(response)) {\n        updateLifecycleStatus({\n          statusName: 'error',\n          statusData: {\n            code: response.code,\n            error: response.error,\n            message: response.message,\n          },\n        });\n        return;\n      }\n      await processSwapTransaction({\n        chainId,\n        config: accountConfig,\n        isSponsored,\n        paymaster: paymaster || '',\n        sendCallsAsync,\n        sendTransactionAsync,\n        swapTransaction: response,\n        switchChainAsync,\n        updateLifecycleStatus,\n        useAggregator,\n        walletCapabilities,\n      });\n    } catch (err) {\n      const errorMessage = isUserRejectedRequestError(err)\n        ? 'Request denied.'\n        : GENERIC_ERROR_MESSAGE;\n      updateLifecycleStatus({\n        statusName: 'error',\n        statusData: {\n          code: 'TmSPc02', // Transaction module SwapProvider component 02 error\n          error: JSON.stringify(err),\n          message: errorMessage,\n        },\n      });\n    }\n  }, [\n    accountConfig,\n    address,\n    chainId,\n    from.amount,\n    from.token,\n    isSponsored,\n    lifecycleStatus,\n    paymaster,\n    sendCallsAsync,\n    sendTransactionAsync,\n    switchChainAsync,\n    to.token,\n    updateLifecycleStatus,\n    useAggregator,\n    walletCapabilities,\n    sendAnalytics,\n  ]);\n\n  const value = useValue({\n    address,\n    config,\n    from,\n    handleAmountChange,\n    handleToggle,\n    handleSubmit,\n    lifecycleStatus,\n    updateLifecycleStatus,\n    to,\n    isToastVisible,\n    setIsToastVisible,\n    setTransactionHash,\n    transactionHash,\n  });\n\n  return <SwapContext.Provider value={value}>{children}</SwapContext.Provider>;\n}\n"],"names":["emptyContext","SwapContext","createContext","useSwapContext","context","useContext","Error","SwapProvider","children","config","maxSlippage","FALLBACK_DEFAULT_MAX_SLIPPAGE","experimental","isSponsored","onError","onStatus","onSuccess","paymaster","undefined","useOnchainKit","address","chainId","useAccount","switchChainAsync","useSwitchChain","useAggregator","accountConfig","useConfig","walletCapabilities","useCapabilitiesSafe","base","id","lifecycleStatus","updateLifecycleStatus","useLifecycleStatus","statusName","statusData","isMissingRequiredField","isToastVisible","setIsToastVisible","useState","transactionHash","setTransactionHash","hasHandledSuccess","setHasHandledSuccess","from","to","useFromTo","sendTransactionAsync","useSendTransaction","sendCallsAsync","useSendCalls","resetInputs","useResetInputs","awaitCallsStatus","useAwaitCalls","sendAnalytics","useAnalytics","useEffect","SwapEvent","SwapFailure","error","metadata","transactionReceipt","SwapSuccess","amount","Number","token","symbol","transactionType","handleToggle","useCallback","setAmount","setToken","amountFrom","amountTo","tokenFrom","tokenTo","handleAmountChange","type","sToken","dToken","source","destination","parseFloat","setAmountUSD","setLoading","response","getSwapQuote","amountReference","String","RequestContext","Swap","isSwapError","code","message","formattedAmount","formatTokenAmount","toAmount","decimals","toAmountUSD","fromAmountUSD","err","JSON","stringify","handleSubmit","SwapInitiated","buildSwapTransaction","fromAddress","processSwapTransaction","swapTransaction","errorMessage","isUserRejectedRequestError","GENERIC_ERROR_MESSAGE","value","useValue"],"mappings":"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"}