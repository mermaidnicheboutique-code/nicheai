{"version":3,"file":"useAwaitCalls.js","sources":["../../../src/swap/hooks/useAwaitCalls.ts"],"sourcesContent":["import { useCallback } from 'react';\nimport { waitForTransactionReceipt } from 'wagmi/actions';\nimport { useCallsStatus } from 'wagmi/experimental';\nimport type { UseAwaitCallsParams } from '../types';\nimport { normalizeStatus } from '@/internal/utils/normalizeWagmi';\n\nexport function useAwaitCalls({\n  accountConfig,\n  lifecycleStatus,\n  updateLifecycleStatus,\n}: UseAwaitCallsParams) {\n  const callsId =\n    lifecycleStatus.statusName === 'transactionApproved'\n      ? lifecycleStatus.statusData?.callsId\n      : undefined;\n\n  const { data } = useCallsStatus({\n    id: callsId || '',\n    query: {\n      refetchInterval: (query) => {\n        return normalizeStatus(query.state.data?.status) === 'success'\n          ? false\n          : 1000;\n      },\n      enabled: callsId !== undefined,\n    },\n  });\n\n  return useCallback(async () => {\n    if (normalizeStatus(data?.status) === 'success' && data?.receipts) {\n      const transactionReceipt = await waitForTransactionReceipt(\n        accountConfig,\n        {\n          confirmations: 1,\n          hash: data.receipts[data.receipts.length - 1].transactionHash,\n        },\n      );\n      updateLifecycleStatus({\n        statusName: 'success',\n        statusData: {\n          transactionReceipt,\n        },\n      });\n    }\n  }, [accountConfig, data, updateLifecycleStatus]);\n}\n"],"names":["useAwaitCalls","accountConfig","lifecycleStatus","updateLifecycleStatus","callsId","statusName","statusData","undefined","data","useCallsStatus","id","query","refetchInterval","normalizeStatus","state","status","enabled","useCallback","receipts","transactionReceipt","waitForTransactionReceipt","confirmations","hash","length","transactionHash"],"mappings":";;;;AAMO,SAASA,cAAc;AAAA,EAC5BC;AAAAA,EACAC;AAAAA,EACAC;AACmB,GAAG;;AACtB,QAAMC,UACJF,gBAAgBG,eAAe,yBAC3BH,qBAAgBI,eAAhBJ,mBAA4BE,UAC5BG;AAEA,QAAA;AAAA,IAAEC;AAAAA,MAASC,eAAe;AAAA,IAC9BC,IAAIN,WAAW;AAAA,IACfO,OAAO;AAAA,MACLC,iBAAkBD,CAAU,UAAA;;AAC1B,eAAOE,iBAAgBF,MAAAA,MAAMG,MAAMN,SAAZG,gBAAAA,IAAkBI,MAAM,MAAM,YACjD,QACA;AAAA,MACN;AAAA,MACAC,SAASZ,YAAYG;AAAAA,IAAAA;AAAAA,EACvB,CACD;AAED,SAAOU,YAAY,YAAY;AAC7B,QAAIJ,gBAAgBL,6BAAMO,MAAM,MAAM,cAAaP,6BAAMU,WAAU;AAC3DC,YAAAA,qBAAqB,MAAMC,0BAC/BnB,eACA;AAAA,QACEoB,eAAe;AAAA,QACfC,MAAMd,KAAKU,SAASV,KAAKU,SAASK,SAAS,CAAC,EAAEC;AAAAA,MAAAA,CAElD;AACsB,4BAAA;AAAA,QACpBnB,YAAY;AAAA,QACZC,YAAY;AAAA,UACVa;AAAAA,QAAAA;AAAAA,MACF,CACD;AAAA,IAAA;AAAA,EAEF,GAAA,CAAClB,eAAeO,MAAML,qBAAqB,CAAC;AACjD;"}