'use client';
import { jsx, jsxs } from "react/jsx-runtime";
import { useEarnContext } from "./EarnProvider.js";
import { getTruncatedAmount } from "../utils/getTruncatedAmount.js";
import { Popover } from "../../internal/components/Popover.js";
import { Skeleton } from "../../internal/components/Skeleton.js";
import { infoSvg } from "../../internal/svg/infoSvg.js";
import { formatPercent } from "../../internal/utils/formatPercent.js";
import { cn, text } from "../../styles/theme.js";
import { PopoverTrigger } from "@radix-ui/react-popover";
import { useState } from "react";
function YieldInfo() {
  const {
    rewards,
    nativeApy,
    vaultToken,
    vaultFee
  } = useEarnContext();
  return /* @__PURE__ */ jsxs("div", { className: cn("ock:text-ock-foreground-muted", "ock:border-ock-background-active", "ock:bg-ock-background", "ock:fade-in ock:flex ock:min-w-52 ock:animate-in ock:flex-col ock:gap-2 ock:rounded-lg ock:border ock:p-3 ock:text-sm ock:duration-200"), children: [
    nativeApy ? /* @__PURE__ */ jsxs("div", { className: "ock:flex ock:items-center ock:justify-between ock:gap-1", "data-testid": "ock-earnNativeApy", children: [
      /* @__PURE__ */ jsx("div", { children: vaultToken == null ? void 0 : vaultToken.symbol }),
      /* @__PURE__ */ jsx("div", { className: "ock:font-semibold", children: formatPercent(nativeApy) })
    ] }) : null,
    rewards == null ? void 0 : rewards.map((reward) => /* @__PURE__ */ jsxs("div", { className: "ock:flex ock:items-center ock:justify-between ock:gap-1", "data-testid": "ock-earnRewards", children: [
      /* @__PURE__ */ jsx("div", { children: reward.assetName }),
      /* @__PURE__ */ jsx("div", { className: "ock:font-semibold", children: formatPercent(reward.apy) })
    ] }, reward.asset)),
    vaultFee && nativeApy ? /* @__PURE__ */ jsxs("div", { className: "ock:flex ock:items-center ock:justify-between ock:gap-1", "data-testid": "ock-earnPerformanceFee", children: [
      /* @__PURE__ */ jsxs("div", { children: [
        "Perf. Fee",
        " ",
        /* @__PURE__ */ jsxs("span", { className: "ock:text-xs", children: [
          "(",
          formatPercent(vaultFee, 0),
          ")"
        ] })
      ] }),
      /* @__PURE__ */ jsxs("div", { className: "ock:font-semibold", children: [
        "-",
        formatPercent(vaultFee * nativeApy)
      ] })
    ] }) : null
  ] });
}
function YieldDetails() {
  const [isOpen, setIsOpen] = useState(false);
  const {
    apy
  } = useEarnContext();
  if (!apy) {
    return /* @__PURE__ */ jsx(Skeleton, { className: "ock:!rounded-full ock:h-7 ock:min-w-28" });
  }
  return /* @__PURE__ */ jsx(Popover, { open: isOpen, onOpenChange: setIsOpen, side: "bottom", align: "end", sideOffset: 4, anchor: /* @__PURE__ */ jsxs("div", { className: cn(text.label1, "ock:text-ock-foreground-muted", "ock:bg-ock-background-alternate", "ock:flex ock:items-center ock:justify-center ock:gap-1 ock:rounded-full ock:p-1 ock:px-3"), "data-testid": "ock-yieldDetails", children: [
    `APY ${formatPercent(Number(getTruncatedAmount(apy.toString(), 4)))}`,
    /* @__PURE__ */ jsx(PopoverTrigger, { asChild: true, children: /* @__PURE__ */ jsx("button", { type: "button", "data-testid": "ock-apyInfoButton", className: cn("ock:size-3 ock:[&_path]:fill-ock-foreground-muted ock:[&_path]:transition-colors ock:[&_path]:ease-in-out ock:[&_path]:hover:fill-ock-foreground", isOpen && "ock:[&_path]:fill-ock-foreground"), onClick: () => setIsOpen(!isOpen), children: infoSvg }) })
  ] }), children: /* @__PURE__ */ jsx(YieldInfo, {}) });
}
export {
  YieldDetails
};
//# sourceMappingURL=YieldDetails.js.map
