'use client';
import { jsx } from "react/jsx-runtime";
import { useDepositAnalytics } from "../hooks/useDepositAnalytics.js";
import { cn } from "../../styles/theme.js";
import { Transaction } from "../../transaction/components/Transaction.js";
import { TransactionButton } from "../../transaction/components/TransactionButton.js";
import "../../transaction/components/TransactionProvider.js";
import { useState, useCallback } from "react";
import "wagmi";
import "wagmi/experimental";
import "../../core/network/getChainExplorer.js";
import "@radix-ui/react-toast";
import { ConnectWallet } from "../../wallet/components/ConnectWallet.js";
import "../../identity/components/IdentityProvider.js";
import "viem";
import "viem/chains";
import "viem/ens";
import "../../identity/constants.js";
import "@tanstack/react-query";
import "../../core/network/attestations.js";
import "../../identity/utils/easSupportedChains.js";
import "../../styles/constants.js";
import "../../useOnchainKit.js";
import "@floating-ui/react";
import "@radix-ui/react-dialog";
import "../../token/constants.js";
import "../../internal/components/QrCode/useLogo.js";
import "qrcode";
import "../../wallet/components/WalletProvider.js";
import "@farcaster/miniapp-sdk";
import "../../internal/components/TextInput.js";
import "../../token/components/TokenRow.js";
import "@radix-ui/react-dropdown-menu";
import "../../internal/components/LayerConfigProvider.js";
import "../../token/components/TokenSelectButton.js";
import "../../swap/components/SwapProvider.js";
import "@radix-ui/react-popover";
import "../../wallet/components/wallet-advanced-send/components/SendAmountInputTypeSwitch.js";
import "../../wallet/components/wallet-advanced-send/components/SendProvider.js";
import "../../fund/components/FundCardProvider.js";
import "../../fund/components/FundCardPaymentMethodSelectRow.js";
import "../../fund/components/FundCardPaymentMethodSelectorToggle.js";
import "../../internal/svg/trustWalletSvg.js";
import "wagmi/connectors";
import "viem/account-abstraction";
import { useEarnContext } from "./EarnProvider.js";
import { RenderDepositButton } from "./RenderDepositButton.js";
function DepositButton({
  className
}) {
  const {
    recipientAddress: address,
    vaultToken,
    depositCalls,
    depositAmount,
    setDepositAmount,
    depositAmountError,
    updateLifecycleStatus,
    refetchWalletBalance,
    isSponsored
  } = useEarnContext();
  const [depositedAmount, setDepositedAmount] = useState("");
  const {
    setTransactionState
  } = useDepositAnalytics(depositedAmount);
  const handleOnStatus = useCallback((status) => {
    setTransactionState(status.statusName);
    if (status.statusName === "transactionPending") {
      updateLifecycleStatus({
        statusName: "transactionPending"
      });
    }
    if (status.statusName === "transactionLegacyExecuted" || status.statusName === "success" || status.statusName === "error") {
      updateLifecycleStatus(status);
    }
  }, [updateLifecycleStatus, setTransactionState]);
  const handleOnSuccess = useCallback((res) => {
    if (res.transactionReceipts[0] && res.transactionReceipts[0].status === "success") {
      if (depositAmount) {
        setDepositedAmount(depositAmount);
      }
      setDepositAmount("");
      refetchWalletBalance();
    }
  }, [depositAmount, setDepositAmount, refetchWalletBalance]);
  if (!address) {
    return /* @__PURE__ */ jsx(ConnectWallet, { className: cn("ock:w-full", className), disconnectedLabel: "Connect to deposit" });
  }
  return /* @__PURE__ */ jsx(Transaction, { className, calls: depositCalls, onStatus: handleOnStatus, onSuccess: handleOnSuccess, isSponsored, resetAfter: 3e3, children: /* @__PURE__ */ jsx(TransactionButton, { render: (params) => {
    return /* @__PURE__ */ jsx(RenderDepositButton, { ...params, depositAmountError, depositedAmount, vaultToken });
  }, disabled: !!depositAmountError || !depositAmount }) });
}
export {
  DepositButton
};
//# sourceMappingURL=DepositButton.js.map
