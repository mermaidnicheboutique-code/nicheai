{"version":3,"file":"FundCardSubmitButton.js","sources":["../../../src/fund/components/FundCardSubmitButton.tsx"],"sourcesContent":["'use client';\nimport { Spinner } from '@/internal/components/Spinner';\nimport { ErrorSvg } from '@/internal/svg/errorSvg';\nimport { SuccessSvg } from '@/internal/svg/successSvg';\nimport { useCallback, useMemo } from 'react';\nimport { useFundCardFundingUrl } from '../hooks/useFundCardFundingUrl';\nimport { FundCardSubmitButtonProps } from '../types';\nimport { FundButton } from './FundButton';\nimport { useFundContext } from './FundCardProvider';\n\nexport function FundCardSubmitButton({\n  children,\n  render,\n}: FundCardSubmitButtonProps) {\n  const {\n    fundAmountFiat,\n    fundAmountCrypto,\n    submitButtonState,\n    setSubmitButtonState,\n    currency,\n    updateLifecycleStatus,\n    sessionToken,\n  } = useFundContext();\n\n  const fundingUrl = useFundCardFundingUrl();\n\n  const handleOnClick = useCallback(\n    () => setSubmitButtonState('loading'),\n    [setSubmitButtonState],\n  );\n\n  const handleOnPopupClose = useCallback(() => {\n    updateLifecycleStatus({ statusName: 'exit', statusData: undefined });\n    setSubmitButtonState('default');\n  }, [updateLifecycleStatus, setSubmitButtonState]);\n\n  const isButtonDisabled = useMemo(\n    () =>\n      (!fundAmountFiat || Number(fundAmountCrypto) === 0) &&\n      (!fundAmountCrypto || Number(fundAmountFiat) === 0),\n    [fundAmountCrypto, fundAmountFiat],\n  );\n\n  const buttonIcon = useMemo(() => {\n    switch (submitButtonState) {\n      case 'loading':\n        return '';\n      case 'success':\n        return <SuccessSvg className=\"fill-[#F9FAFB]\" />;\n      case 'error':\n        return <ErrorSvg className=\"fill-[#F9FAFB]\" />;\n      default:\n        return null;\n    }\n  }, [submitButtonState]);\n\n  const buttonTextContent = useMemo(() => {\n    switch (submitButtonState) {\n      case 'loading':\n        return '';\n      case 'success':\n        return 'Success';\n      case 'error':\n        return 'Something went wrong';\n      default:\n        return 'Buy';\n    }\n  }, [submitButtonState]);\n\n  const buttonContent = useMemo(() => {\n    if (submitButtonState === 'loading') {\n      return <Spinner />;\n    }\n\n    return (\n      <>\n        {buttonIcon && (\n          <span\n            data-testid=\"ockFundButtonIcon\"\n            className=\"flex h-6 items-center\"\n          >\n            {buttonIcon}\n          </span>\n        )}\n        <span data-testid=\"ockFundButtonTextContent\">{buttonTextContent}</span>\n      </>\n    );\n  }, [submitButtonState, buttonIcon, buttonTextContent]);\n\n  // FundButton accepts render prop or children but not both\n  if (render) {\n    return (\n      <FundButton\n        disabled={isButtonDisabled}\n        sessionToken={sessionToken}\n        fundingUrl={fundingUrl}\n        state={submitButtonState}\n        onClick={handleOnClick}\n        onPopupClose={handleOnPopupClose}\n        fiatCurrency={currency}\n        render={render}\n      />\n    );\n  }\n\n  return (\n    <FundButton\n      disabled={isButtonDisabled}\n      className=\"w-full\"\n      sessionToken={sessionToken}\n      fundingUrl={fundingUrl}\n      state={submitButtonState}\n      onClick={handleOnClick}\n      onPopupClose={handleOnPopupClose}\n      fiatCurrency={currency}\n    >\n      {children || buttonContent}\n    </FundButton>\n  );\n}\n"],"names":["FundCardSubmitButton","children","render","fundAmountFiat","fundAmountCrypto","submitButtonState","setSubmitButtonState","currency","updateLifecycleStatus","sessionToken","useFundContext","fundingUrl","useFundCardFundingUrl","handleOnClick","useCallback","handleOnPopupClose","statusName","statusData","undefined","isButtonDisabled","useMemo","Number","buttonIcon","buttonTextContent","buttonContent"],"mappings":";;;;;;;;AAUO,SAASA,qBAAqB;AAAA,EACnCC;AAAAA,EACAC;AACyB,GAAG;AACtB,QAAA;AAAA,IACJC;AAAAA,IACAC;AAAAA,IACAC;AAAAA,IACAC;AAAAA,IACAC;AAAAA,IACAC;AAAAA,IACAC;AAAAA,MACEC,eAAe;AAEnB,QAAMC,aAAaC,sBAAsB;AAEnCC,QAAAA,gBAAgBC,YACpB,MAAMR,qBAAqB,SAAS,GACpC,CAACA,oBAAoB,CACvB;AAEMS,QAAAA,qBAAqBD,YAAY,MAAM;AACrB,0BAAA;AAAA,MAAEE,YAAY;AAAA,MAAQC,YAAYC;AAAAA,IAAAA,CAAW;AACnEZ,yBAAqB,SAAS;AAAA,EAAA,GAC7B,CAACE,uBAAuBF,oBAAoB,CAAC;AAEhD,QAAMa,mBAAmBC,QACvB,OACG,CAACjB,kBAAkBkB,OAAOjB,gBAAgB,MAAM,OAChD,CAACA,oBAAoBiB,OAAOlB,cAAc,MAAM,IACnD,CAACC,kBAAkBD,cAAc,CACnC;AAEMmB,QAAAA,aAAaF,QAAQ,MAAM;AAC/B,YAAQf,mBAAiB;AAAA,MACvB,KAAK;AACI,eAAA;AAAA,MACT,KAAK;AACI,eAAA,oBAAC,YAAW,EAAA,WAAU,qBAAmB,CAAA;AAAA,MAClD,KAAK;AACI,eAAA,oBAAC,UAAS,EAAA,WAAU,qBAAmB,CAAA;AAAA,MAChD;AACS,eAAA;AAAA,IAAA;AAAA,EACX,GACC,CAACA,iBAAiB,CAAC;AAEhBkB,QAAAA,oBAAoBH,QAAQ,MAAM;AACtC,YAAQf,mBAAiB;AAAA,MACvB,KAAK;AACI,eAAA;AAAA,MACT,KAAK;AACI,eAAA;AAAA,MACT,KAAK;AACI,eAAA;AAAA,MACT;AACS,eAAA;AAAA,IAAA;AAAA,EACX,GACC,CAACA,iBAAiB,CAAC;AAEhBmB,QAAAA,gBAAgBJ,QAAQ,MAAM;AAClC,QAAIf,sBAAsB,WAAW;AACnC,iCAAQ,SAAU,EAAA;AAAA,IAAA;AAGpB,WAEKiB,qBAAAA,UAAAA,EAAAA,UAAAA;AAAAA,MAAAA,kCACE,QACC,EAAA,eAAY,qBACZ,WAAU,qCAETA,UACH,YAAA;AAAA,MAED,oBAAA,QAAA,EAAK,eAAY,4BAA4BC,UAAkB,kBAAA,CAAA;AAAA,IAAA,GAClE;AAAA,EAED,GAAA,CAAClB,mBAAmBiB,YAAYC,iBAAiB,CAAC;AAGrD,MAAIrB,QAAQ;AACV,WACG,oBAAA,YAAA,EACC,UAAUiB,kBACV,cACA,YACA,OAAOd,mBACP,SAASQ,eACT,cAAcE,oBACd,cAAcR,UACd,QACA;AAAA,EAAA;AAIN,6BACG,YACC,EAAA,UAAUY,kBACV,WAAU,cACV,cACA,YACA,OAAOd,mBACP,SAASQ,eACT,cAAcE,oBACd,cAAcR,UAEbN,sBAAYuB,eACf;AAEJ;"}