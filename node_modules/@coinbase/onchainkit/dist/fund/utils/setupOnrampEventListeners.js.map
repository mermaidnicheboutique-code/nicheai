{"version":3,"file":"setupOnrampEventListeners.js","sources":["../../../src/fund/utils/setupOnrampEventListeners.ts"],"sourcesContent":["import { DEFAULT_ONRAMP_URL } from '../constants';\nimport type { EventMetadata, OnrampError, SuccessEventData } from '../types';\nimport { subscribeToWindowMessage } from './subscribeToWindowMessage';\n\ntype SetupOnrampEventListenersParams = {\n  host?: string;\n  onSuccess?: (data?: SuccessEventData) => void;\n  onExit?: (error?: OnrampError) => void;\n  onEvent?: (event: EventMetadata) => void;\n};\n\n/**\n * Subscribes to events from the Coinbase Onramp widget.\n * @param onEvent - Callback for when any event is received.\n * @param onExit - Callback for when an exit event is received.\n * @param onSuccess - Callback for when a success event is received.\n * @returns a function to unsubscribe from the event listener.\n */\nexport function setupOnrampEventListeners({\n  onEvent,\n  onExit,\n  onSuccess,\n  host = DEFAULT_ONRAMP_URL,\n}: SetupOnrampEventListenersParams) {\n  const unsubscribe = subscribeToWindowMessage({\n    allowedOrigin: host,\n    onMessage: (data) => {\n      const metadata = data as EventMetadata;\n\n      if (metadata.eventName === 'success') {\n        onSuccess?.(metadata.data);\n      }\n      if (metadata.eventName === 'exit') {\n        onExit?.(metadata.error);\n      }\n      onEvent?.(metadata);\n    },\n  });\n\n  return unsubscribe;\n}\n"],"names":["setupOnrampEventListeners","onEvent","onExit","onSuccess","host","DEFAULT_ONRAMP_URL","unsubscribe","subscribeToWindowMessage","allowedOrigin","onMessage","data","metadata","eventName","error"],"mappings":";;AAkBO,SAASA,0BAA0B;AAAA,EACxCC;AAAAA,EACAC;AAAAA,EACAC;AAAAA,EACAC,OAAOC;AACwB,GAAG;AAClC,QAAMC,cAAcC,yBAAyB;AAAA,IAC3CC,eAAeJ;AAAAA,IACfK,WAAYC,CAAS,SAAA;AACnB,YAAMC,WAAWD;AAEbC,UAAAA,SAASC,cAAc,WAAW;AACpCT,+CAAYQ,SAASD;AAAAA,MAAI;AAEvBC,UAAAA,SAASC,cAAc,QAAQ;AACjCV,yCAASS,SAASE;AAAAA,MAAK;AAEzBZ,yCAAUU;AAAAA,IAAQ;AAAA,EACpB,CACD;AAEML,SAAAA;AACT;"}