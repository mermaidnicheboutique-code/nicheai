{"version":3,"file":"buildPaymentMethods.js","sources":["../../../src/fund/utils/buildPaymentMethods.ts"],"sourcesContent":["import type {\n  OnrampOptionsResponseData,\n  OnrampPaymentCurrency,\n  PaymentMethod,\n} from '../types';\n\nconst DEFAULT_MIN_AMOUNT = 2;\nconst DEFAULT_MAX_AMOUNT = 500;\n\n/**\n * Coinbase payment method description is built using the available payment methods and adding Cash and Crypto Balance to the end of the array.\n * i.e. If the API returns Card and ACH, the description will be \"Card, ACH, Cash, Crypto Balance\".\n */\nexport const buildCoinbasePaymentMethodDescription = (\n  paymentMethodLimits: Array<{ id: string }>,\n) => {\n  const availableMethods = [\n    // Check API-provided methods\n    paymentMethodLimits.some((limit) => limit.id === 'ACH_BANK_ACCOUNT') &&\n      'ACH',\n    paymentMethodLimits.some((limit) => limit.id === 'CARD') && 'debit',\n    // Always include these methods\n    'cash',\n    'crypto balance',\n  ].filter(Boolean); // Remove falsy values\n\n  return availableMethods.join(', ');\n};\n\nconst buildCoinbasePaymentMethod = ({\n  limits,\n}: OnrampPaymentCurrency): PaymentMethod => ({\n  id: '',\n  name: 'Coinbase',\n  description: buildCoinbasePaymentMethodDescription(limits),\n  icon: 'coinbaseLogo',\n  minAmount: Math.min(...limits.map((l) => Number(l.min))),\n  maxAmount: Math.max(...limits.map((l) => Number(l.max))),\n});\n\nconst buildUSPaymentMethods = (\n  paymentCurrency: OnrampPaymentCurrency,\n): PaymentMethod[] => {\n  const paymentMethodConfigs = [\n    {\n      id: 'APPLE_PAY',\n      name: 'Apple Pay',\n      icon: 'apple',\n    },\n    {\n      id: 'CARD',\n      name: 'Debit card',\n      icon: 'creditCard',\n    },\n  ];\n\n  return paymentMethodConfigs.map((config) => {\n    const limit = paymentCurrency.limits?.find(\n      (limit) => limit.id === config.id,\n    );\n\n    return {\n      ...config,\n      description: 'Up to $500/week. No sign up required.',\n      minAmount: Number(limit?.min) || DEFAULT_MIN_AMOUNT,\n      maxAmount: Number(limit?.max) || DEFAULT_MAX_AMOUNT,\n    };\n  });\n};\n\nexport const buildPaymentMethods = (\n  paymentOptions: OnrampOptionsResponseData,\n  currency: string,\n  country: string,\n) => {\n  const paymentCurrency = paymentOptions.paymentCurrencies?.find(\n    (paymentCurrency) => paymentCurrency.id === currency,\n  );\n\n  if (!paymentCurrency) {\n    return [];\n  }\n\n  const coinbasePaymentMethod = buildCoinbasePaymentMethod(paymentCurrency);\n\n  let usPaymentMethods: PaymentMethod[] = [];\n  if (country === 'US' && currency === 'USD') {\n    usPaymentMethods = buildUSPaymentMethods(paymentCurrency);\n  }\n\n  return [coinbasePaymentMethod, ...usPaymentMethods];\n};\n"],"names":["DEFAULT_MIN_AMOUNT","DEFAULT_MAX_AMOUNT","buildCoinbasePaymentMethodDescription","paymentMethodLimits","availableMethods","some","limit","id","filter","Boolean","join","buildCoinbasePaymentMethod","limits","name","description","icon","minAmount","Math","min","map","l","Number","maxAmount","max","buildUSPaymentMethods","paymentCurrency","paymentMethodConfigs","config","find","buildPaymentMethods","paymentOptions","currency","country","paymentCurrencies","coinbasePaymentMethod","usPaymentMethods"],"mappings":"AAMA,MAAMA,qBAAqB;AAC3B,MAAMC,qBAAqB;AAMdC,MAAAA,wCAAwCA,CACnDC,wBACG;AACH,QAAMC,mBAAmB;AAAA;AAAA,IAEvBD,oBAAoBE,KAAMC,CAAAA,UAAUA,MAAMC,OAAO,kBAAkB,KACjE;AAAA,IACFJ,oBAAoBE,KAAMC,CAAAA,UAAUA,MAAMC,OAAO,MAAM,KAAK;AAAA;AAAA,IAE5D;AAAA,IACA;AAAA,EAAA,EACAC,OAAOC,OAAO;AAETL,SAAAA,iBAAiBM,KAAK,IAAI;AACnC;AAEA,MAAMC,6BAA6BA,CAAC;AAAA,EAClCC;AACqB,OAAsB;AAAA,EAC3CL,IAAI;AAAA,EACJM,MAAM;AAAA,EACNC,aAAaZ,sCAAsCU,MAAM;AAAA,EACzDG,MAAM;AAAA,EACNC,WAAWC,KAAKC,IAAI,GAAGN,OAAOO,IAAKC,CAAAA,MAAMC,OAAOD,EAAEF,GAAG,CAAC,CAAC;AAAA,EACvDI,WAAWL,KAAKM,IAAI,GAAGX,OAAOO,IAAKC,CAAAA,MAAMC,OAAOD,EAAEG,GAAG,CAAC,CAAC;AACzD;AAEA,MAAMC,wBAAwBA,CAC5BC,oBACoB;AACpB,QAAMC,uBAAuB,CAC3B;AAAA,IACEnB,IAAI;AAAA,IACJM,MAAM;AAAA,IACNE,MAAM;AAAA,EAAA,GAER;AAAA,IACER,IAAI;AAAA,IACJM,MAAM;AAAA,IACNE,MAAM;AAAA,EAAA,CACP;AAGIW,SAAAA,qBAAqBP,IAAKQ,CAAW,WAAA;AAlD9C;AAmDUrB,UAAAA,SAAQmB,qBAAgBb,WAAhBa,mBAAwBG,KACnCtB,CAAAA,WAAUA,OAAMC,OAAOoB,OAAOpB;AAG1B,WAAA;AAAA,MACL,GAAGoB;AAAAA,MACHb,aAAa;AAAA,MACbE,WAAWK,OAAOf,+BAAOY,GAAG,KAAKlB;AAAAA,MACjCsB,WAAWD,OAAOf,+BAAOiB,GAAG,KAAKtB;AAAAA,IACnC;AAAA,EAAA,CACD;AACH;AAEO,MAAM4B,sBAAsBA,CACjCC,gBACAC,UACAC,YACG;AApEL;AAqEQP,QAAAA,mBAAkBK,oBAAeG,sBAAfH,mBAAkCF,KACvDH,CAAAA,qBAAoBA,iBAAgBlB,OAAOwB;AAG9C,MAAI,CAACN,iBAAiB;AACpB,WAAO,CAAE;AAAA,EAAA;AAGLS,QAAAA,wBAAwBvB,2BAA2Bc,eAAe;AAExE,MAAIU,mBAAoC,CAAE;AACtCH,MAAAA,YAAY,QAAQD,aAAa,OAAO;AAC1CI,uBAAmBX,sBAAsBC,eAAe;AAAA,EAAA;AAGnD,SAAA,CAACS,uBAAuB,GAAGC,gBAAgB;AACpD;"}