{"version":3,"file":"SendButton.js","sources":["../../../../../src/wallet/components/wallet-advanced-send/components/SendButton.tsx"],"sourcesContent":["'use client';\n\nimport type { PortfolioTokenWithFiatValue } from '@/api/types';\nimport type { LifecycleStatusUpdate } from '@/internal/types';\nimport { Transaction } from '@/transaction/components/Transaction';\nimport { TransactionButton } from '@/transaction/components/TransactionButton';\nimport { TransactionStatus } from '@/transaction/components/TransactionStatus';\nimport { TransactionStatusAction } from '@/transaction/components/TransactionStatusAction';\nimport { TransactionStatusLabel } from '@/transaction/components/TransactionStatusLabel';\nimport type {\n  LifecycleStatus,\n  TransactionButtonRenderParams,\n} from '@/transaction/types';\nimport { useCallback } from 'react';\nimport { parseUnits } from 'viem';\nimport { base } from 'viem/chains';\nimport { useWalletContext } from '../../WalletProvider';\nimport { useOnchainKit } from '@/useOnchainKit';\nimport type { SendLifecycleStatus } from '../types';\nimport { getSendCalldata } from '../utils/getSendCalldata';\nimport { useSendContext } from './SendProvider';\nimport { RenderSendButton } from './RenderSendButton';\n\nexport function SendButton() {\n  const { chain: senderChain } = useOnchainKit();\n  const { isSponsored } = useWalletContext();\n  const {\n    recipientState,\n    cryptoAmount: inputAmount,\n    selectedToken,\n    updateLifecycleStatus,\n  } = useSendContext();\n\n  const { calldata, error } = getSendCalldata({\n    recipientAddress: recipientState.address,\n    token: selectedToken,\n    amount: inputAmount,\n  });\n\n  const disableSendButton =\n    Boolean(error) ||\n    !validateAmountInput({\n      inputAmount: inputAmount ?? '',\n      balance: BigInt(selectedToken?.cryptoBalance ?? 0),\n      selectedToken: selectedToken ?? undefined,\n    });\n\n  const buttonLabel = getDefaultSendButtonLabel(inputAmount, selectedToken);\n\n  const handleStatus = useCallback(\n    (status: LifecycleStatus) => {\n      const validStatuses = [\n        'transactionPending',\n        'transactionLegacyExecuted',\n        'success',\n        'error',\n      ] as const;\n      if (\n        validStatuses.includes(\n          status.statusName as (typeof validStatuses)[number],\n        )\n      ) {\n        updateLifecycleStatus(\n          status as LifecycleStatusUpdate<SendLifecycleStatus>,\n        );\n      }\n    },\n    [updateLifecycleStatus],\n  );\n\n  return (\n    <Transaction\n      isSponsored={isSponsored}\n      chainId={senderChain?.id ?? base.id}\n      calls={calldata ? [calldata] : []}\n      onStatus={handleStatus}\n    >\n      <TransactionButton\n        text={buttonLabel}\n        render={(params: TransactionButtonRenderParams) => (\n          <RenderSendButton {...params} label={buttonLabel} />\n        )}\n        disabled={disableSendButton}\n      />\n      <TransactionStatus>\n        <TransactionStatusLabel />\n        <TransactionStatusAction />\n      </TransactionStatus>\n    </Transaction>\n  );\n}\n\nfunction getDefaultSendButtonLabel(\n  cryptoAmount: string | null,\n  selectedToken: PortfolioTokenWithFiatValue | null,\n) {\n  if (!cryptoAmount) {\n    return 'Input amount';\n  }\n\n  if (!selectedToken) {\n    return 'Select token';\n  }\n\n  if (\n    parseUnits(cryptoAmount, selectedToken.decimals) >\n    selectedToken.cryptoBalance\n  ) {\n    return 'Insufficient balance';\n  }\n\n  return 'Continue';\n}\n\nfunction validateAmountInput({\n  inputAmount,\n  balance,\n  selectedToken,\n}: {\n  inputAmount?: string;\n  balance?: bigint;\n  selectedToken?: PortfolioTokenWithFiatValue;\n}) {\n  if (!inputAmount || !selectedToken || !balance) {\n    return false;\n  }\n\n  const parsedCryptoAmount = parseUnits(inputAmount, selectedToken.decimals);\n\n  return parsedCryptoAmount > 0n && parsedCryptoAmount <= balance;\n}\n"],"names":["SendButton","chain","senderChain","useOnchainKit","isSponsored","useWalletContext","recipientState","cryptoAmount","inputAmount","selectedToken","updateLifecycleStatus","useSendContext","calldata","error","getSendCalldata","recipientAddress","address","token","amount","disableSendButton","Boolean","validateAmountInput","balance","BigInt","cryptoBalance","undefined","buttonLabel","getDefaultSendButtonLabel","handleStatus","useCallback","status","validStatuses","includes","statusName","id","base","params","parseUnits","decimals","parsedCryptoAmount"],"mappings":";;;;;;;;;;;;;;AAuBO,SAASA,aAAa;AACrB,QAAA;AAAA,IAAEC,OAAOC;AAAAA,MAAgBC,cAAc;AACvC,QAAA;AAAA,IAAEC;AAAAA,MAAgBC,iBAAiB;AACnC,QAAA;AAAA,IACJC;AAAAA,IACAC,cAAcC;AAAAA,IACdC;AAAAA,IACAC;AAAAA,MACEC,eAAe;AAEb,QAAA;AAAA,IAAEC;AAAAA,IAAUC;AAAAA,MAAUC,gBAAgB;AAAA,IAC1CC,kBAAkBT,eAAeU;AAAAA,IACjCC,OAAOR;AAAAA,IACPS,QAAQV;AAAAA,EAAAA,CACT;AAED,QAAMW,oBACJC,QAAQP,KAAK,KACb,CAACQ,oBAAoB;AAAA,IACnBb,aAAaA,eAAe;AAAA,IAC5Bc,SAASC,QAAOd,+CAAee,kBAAiB,CAAC;AAAA,IACjDf,eAAeA,iBAAiBgB;AAAAA,EAAAA,CACjC;AAEGC,QAAAA,cAAcC,0BAA0BnB,aAAaC,aAAa;AAElEmB,QAAAA,eAAeC,YACnB,CAACC,WAA4B;AAC3B,UAAMC,gBAAgB,CACpB,sBACA,6BACA,WACA,OAAO;AAET,QACEA,cAAcC,SACZF,OAAOG,UACT,GACA;AACAvB,4BACEoB,MACF;AAAA,IAAA;AAAA,EACF,GAEF,CAACpB,qBAAqB,CACxB;AAEA,8BACG,aACC,EAAA,aACA,UAASR,2CAAagC,OAAMC,KAAKD,IACjC,OAAOtB,WAAW,CAACA,QAAQ,IAAI,CAAA,GAC/B,UAAUgB,cAEV,UAAA;AAAA,IAAA,oBAAC,mBACC,EAAA,MAAMF,aACN,QAAQ,CAACU,WACP,oBAAC,uBAAqBA,QAAQ,OAAOV,YAAY,CAAA,GAEnD,UAAUP,mBAAkB;AAAA,yBAE7B,mBACC,EAAA,UAAA;AAAA,MAAA,oBAAC,wBAAsB,EAAA;AAAA,0BACtB,yBAAuB,CAAA,CAAA;AAAA,IAAA,EAC1B,CAAA;AAAA,EAAA,GACF;AAEJ;AAEA,SAASQ,0BACPpB,cACAE,eACA;AACA,MAAI,CAACF,cAAc;AACV,WAAA;AAAA,EAAA;AAGT,MAAI,CAACE,eAAe;AACX,WAAA;AAAA,EAAA;AAGT,MACE4B,WAAW9B,cAAcE,cAAc6B,QAAQ,IAC/C7B,cAAce,eACd;AACO,WAAA;AAAA,EAAA;AAGF,SAAA;AACT;AAEA,SAASH,oBAAoB;AAAA,EAC3Bb;AAAAA,EACAc;AAAAA,EACAb;AAKF,GAAG;AACD,MAAI,CAACD,eAAe,CAACC,iBAAiB,CAACa,SAAS;AACvC,WAAA;AAAA,EAAA;AAGT,QAAMiB,qBAAqBF,WAAW7B,aAAaC,cAAc6B,QAAQ;AAElEC,SAAAA,qBAAqB,MAAMA,sBAAsBjB;AAC1D;"}