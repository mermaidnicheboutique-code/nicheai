{"version":3,"file":"useRecipientState.js","sources":["../../../../../src/wallet/components/wallet-advanced-send/hooks/useRecipientState.tsx"],"sourcesContent":["import { getName } from '@/identity';\nimport { getSlicedAddress } from '@/identity/utils/getSlicedAddress';\nimport { useState, useEffect, useCallback } from 'react';\nimport { base } from 'viem/chains';\nimport { RecipientState } from '../types';\nimport { validateAddressInput } from '../utils/validateAddressInput';\n\nexport function useRecipientState() {\n  const [recipientState, setRecipientState] = useState<RecipientState>({\n    phase: 'input',\n    input: '',\n    address: null,\n    displayValue: null,\n  });\n\n  const updateRecipientInput = useCallback((input: string) => {\n    setRecipientState((prev) => ({\n      ...prev,\n      input,\n    }));\n  }, []);\n\n  const validateRecipientInput = useCallback((input: string) => {\n    validateAddressInput(input).then((validatedAddress) => {\n      if (!validatedAddress) {\n        setRecipientState({\n          phase: 'input',\n          input,\n          address: null,\n          displayValue: null,\n        });\n        return;\n      }\n\n      setRecipientState({\n        phase: 'validated',\n        input,\n        address: validatedAddress,\n        displayValue: null,\n      });\n    });\n  }, []);\n\n  const selectRecipient = useCallback(\n    async (selection: Extract<RecipientState, { phase: 'selected' }>) => {\n      setRecipientState(selection);\n    },\n    [],\n  );\n\n  const deselectRecipient = useCallback(() => {\n    if (recipientState.phase === 'selected') {\n      setRecipientState({\n        phase: 'validated',\n        input: recipientState.input,\n        address: recipientState.address,\n        displayValue: null,\n      });\n    } else {\n      setRecipientState({\n        ...recipientState,\n        displayValue: null,\n      });\n    }\n  }, [recipientState]);\n\n  useEffect(() => {\n    if (recipientState.phase === 'selected') {\n      getName({\n        address: recipientState.address,\n        chain: base,\n      })\n        .then((name) => {\n          setRecipientState({\n            phase: recipientState.phase,\n            input: recipientState.input,\n            address: recipientState.address,\n            displayValue: name ?? getSlicedAddress(recipientState.address),\n          });\n        })\n        .catch(() =>\n          setRecipientState({\n            phase: recipientState.phase,\n            input: recipientState.input,\n            address: recipientState.address,\n            displayValue: getSlicedAddress(recipientState.address),\n          }),\n        );\n    }\n  }, [recipientState.phase, recipientState.address, recipientState.input]);\n\n  return {\n    recipientState,\n    updateRecipientInput,\n    validateRecipientInput,\n    selectRecipient,\n    deselectRecipient,\n  };\n}\n"],"names":["useRecipientState","recipientState","setRecipientState","useState","phase","input","address","displayValue","updateRecipientInput","useCallback","prev","validateRecipientInput","then","validatedAddress","selectRecipient","selection","deselectRecipient","useEffect","chain","base","name","getSlicedAddress","catch"],"mappings":";;;;;;;;;;;;;;;;;AAOO,SAASA,oBAAoB;AAClC,QAAM,CAACC,gBAAgBC,iBAAiB,IAAIC,SAAyB;AAAA,IACnEC,OAAO;AAAA,IACPC,OAAO;AAAA,IACPC,SAAS;AAAA,IACTC,cAAc;AAAA,EAAA,CACf;AAEKC,QAAAA,uBAAuBC,YAAY,CAACJ,UAAkB;AAC1DH,sBAAmBQ,CAAU,UAAA;AAAA,MAC3B,GAAGA;AAAAA,MACHL;AAAAA,IAAAA,EACA;AAAA,EACJ,GAAG,EAAE;AAECM,QAAAA,yBAAyBF,YAAY,CAACJ,UAAkB;AACvCA,yBAAAA,KAAK,EAAEO,KAAMC,CAAqB,qBAAA;AACrD,UAAI,CAACA,kBAAkB;AACH,0BAAA;AAAA,UAChBT,OAAO;AAAA,UACPC;AAAAA,UACAC,SAAS;AAAA,UACTC,cAAc;AAAA,QAAA,CACf;AACD;AAAA,MAAA;AAGgB,wBAAA;AAAA,QAChBH,OAAO;AAAA,QACPC;AAAAA,QACAC,SAASO;AAAAA,QACTN,cAAc;AAAA,MAAA,CACf;AAAA,IAAA,CACF;AAAA,EACH,GAAG,EAAE;AAECO,QAAAA,kBAAkBL,YACtB,OAAOM,cAA8D;AACnEb,sBAAkBa,SAAS;AAAA,EAC7B,GACA,EACF;AAEMC,QAAAA,oBAAoBP,YAAY,MAAM;AACtCR,QAAAA,eAAeG,UAAU,YAAY;AACrB,wBAAA;AAAA,QAChBA,OAAO;AAAA,QACPC,OAAOJ,eAAeI;AAAAA,QACtBC,SAASL,eAAeK;AAAAA,QACxBC,cAAc;AAAA,MAAA,CACf;AAAA,IAAA,OACI;AACa,wBAAA;AAAA,QAChB,GAAGN;AAAAA,QACHM,cAAc;AAAA,MAAA,CACf;AAAA,IAAA;AAAA,EACH,GACC,CAACN,cAAc,CAAC;AAEnBgB,YAAU,MAAM;AACVhB,QAAAA,eAAeG,UAAU,YAAY;AAC/B,cAAA;AAAA,QACNE,SAASL,eAAeK;AAAAA,QACxBY,OAAOC;AAAAA,MAAAA,CACR,EACEP,KAAMQ,CAAS,SAAA;AACI,0BAAA;AAAA,UAChBhB,OAAOH,eAAeG;AAAAA,UACtBC,OAAOJ,eAAeI;AAAAA,UACtBC,SAASL,eAAeK;AAAAA,UACxBC,cAAca,QAAQC,iBAAiBpB,eAAeK,OAAO;AAAA,QAAA,CAC9D;AAAA,MAAA,CACF,EACAgB,MAAM,MACLpB,kBAAkB;AAAA,QAChBE,OAAOH,eAAeG;AAAAA,QACtBC,OAAOJ,eAAeI;AAAAA,QACtBC,SAASL,eAAeK;AAAAA,QACxBC,cAAcc,iBAAiBpB,eAAeK,OAAO;AAAA,MAAA,CACtD,CACH;AAAA,IAAA;AAAA,EACJ,GACC,CAACL,eAAeG,OAAOH,eAAeK,SAASL,eAAeI,KAAK,CAAC;AAEhE,SAAA;AAAA,IACLJ;AAAAA,IACAO;AAAAA,IACAG;AAAAA,IACAG;AAAAA,IACAE;AAAAA,EACF;AACF;"}