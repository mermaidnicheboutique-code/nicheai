{"version":3,"file":"checkWalletAndRedirect.js","sources":["../../../src/wallet/utils/checkWalletAndRedirect.ts"],"sourcesContent":["/**\n * Phantom wallet uses dual injection:\n * - window.phantom object\n * - window.ethereum.isPhantom flag (when active)\n * This interface adds type safety for the non-standard window.phantom property.\n */\nexport interface WindowWithPhantom extends Window {\n  phantom?: {\n    ethereum?: {\n      isPhantom?: boolean;\n    };\n  };\n}\n\nexport function isWalletInstalled(walletType: string): boolean {\n  // Check if we're in a non-browser environment (e.g., SSR/Node.js)\n  // This prevents ReferenceError when window is not defined\n  if (typeof window === 'undefined') {\n    return false;\n  }\n\n  // Handle case when window.ethereum is undefined\n  // This can happen in browsers without any wallet extensions installed\n  // or when the wallet extension hasn't injected its provider yet\n  if (!window.ethereum) {\n    // Special case for Phantom which has dual injection pattern:\n    // It can be detected via window.phantom even when window.ethereum is undefined\n    if (walletType === 'phantom') {\n      return !!(window as WindowWithPhantom).phantom?.ethereum?.isPhantom;\n    }\n    return false;\n  }\n\n  switch (walletType) {\n    case 'phantom':\n      return (\n        !!(window as WindowWithPhantom).phantom?.ethereum?.isPhantom ||\n        !!window.ethereum.isPhantom\n      );\n    case 'rabby':\n      return !!window.ethereum.isRabby;\n    case 'trust':\n      return !!window.ethereum.isTrust || !!window.ethereum.isTrustWallet;\n    case 'frame':\n      return !!window.ethereum.isFrame;\n    default:\n      return false;\n  }\n}\n\n/**\n * Wallet installation URLs\n * Note: MetaMask and Coinbase Wallet are not included here as they have built-in\n * redirection mechanisms in their connectors.\n */\nexport const WALLET_INSTALL_URLS: Record<string, string> = {\n  phantom: 'https://phantom.app/download',\n  rabby: 'https://rabby.io',\n  trust: 'https://trustwallet.com/download',\n  frame: 'https://frame.sh',\n};\n\nexport function redirectToWalletInstall(walletType: string): boolean {\n  const url = WALLET_INSTALL_URLS[walletType];\n  if (!url) {\n    return false;\n  }\n\n  window.open(url, '_blank', 'noopener,noreferrer');\n  return true;\n}\n\n/**\n * Check if the wallet is installed, and redirect to installation page if not\n */\nexport function checkWalletAndRedirect(walletType: string): boolean {\n  const isInstalled = isWalletInstalled(walletType);\n\n  if (!isInstalled) {\n    redirectToWalletInstall(walletType);\n  }\n\n  return isInstalled;\n}\n"],"names":["isWalletInstalled","walletType","window","ethereum","phantom","isPhantom","isRabby","isTrust","isTrustWallet","isFrame","WALLET_INSTALL_URLS","rabby","trust","frame","redirectToWalletInstall","url","open","checkWalletAndRedirect","isInstalled"],"mappings":"AAcO,SAASA,kBAAkBC,YAA6B;AAAxD;AAGD,MAAA,OAAOC,WAAW,aAAa;AAC1B,WAAA;AAAA,EAAA;AAML,MAAA,CAACA,OAAOC,UAAU;AAGpB,QAAIF,eAAe,WAAW;AAC5B,aAAO,CAAC,GAAEC,kBAA6BE,YAA7BF,mBAAsCC,aAAtCD,mBAAgDG;AAAAA,IAAAA;AAErD,WAAA;AAAA,EAAA;AAGT,UAAQJ,YAAU;AAAA,IAChB,KAAK;AAED,aAAA,CAAC,GAAEC,kBAA6BE,YAA7BF,mBAAsCC,aAAtCD,mBAAgDG,cACnD,CAAC,CAACH,OAAOC,SAASE;AAAAA,IAEtB,KAAK;AACI,aAAA,CAAC,CAACH,OAAOC,SAASG;AAAAA,IAC3B,KAAK;AACI,aAAA,CAAC,CAACJ,OAAOC,SAASI,WAAW,CAAC,CAACL,OAAOC,SAASK;AAAAA,IACxD,KAAK;AACI,aAAA,CAAC,CAACN,OAAOC,SAASM;AAAAA,IAC3B;AACS,aAAA;AAAA,EAAA;AAEb;AAOO,MAAMC,sBAA8C;AAAA,EACzDN,SAAS;AAAA,EACTO,OAAO;AAAA,EACPC,OAAO;AAAA,EACPC,OAAO;AACT;AAEO,SAASC,wBAAwBb,YAA6B;AAC7Dc,QAAAA,MAAML,oBAAoBT,UAAU;AAC1C,MAAI,CAACc,KAAK;AACD,WAAA;AAAA,EAAA;AAGFC,SAAAA,KAAKD,KAAK,UAAU,qBAAqB;AACzC,SAAA;AACT;AAKO,SAASE,uBAAuBhB,YAA6B;AAC5DiB,QAAAA,cAAclB,kBAAkBC,UAAU;AAEhD,MAAI,CAACiB,aAAa;AAChBJ,4BAAwBb,UAAU;AAAA,EAAA;AAG7BiB,SAAAA;AACT;"}