{"version":3,"file":"usePortfolio.js","sources":["../../../src/wallet/hooks/usePortfolio.ts"],"sourcesContent":["import { getPortfolios } from '@/api/getPortfolios';\nimport type { Portfolio } from '@/api/types';\nimport { RequestContext, RequestContextType } from '@/core/network/constants';\nimport { isApiError } from '@/internal/utils/isApiResponseError';\nimport { type UseQueryResult, useQuery } from '@tanstack/react-query';\nimport type { Address } from 'viem';\n\ntype UsePortfolioProps = {\n  address: Address | undefined | null;\n  enabled?: boolean;\n};\n\n/**\n * Retrieves the portfolio for the provided address\n * portfolio includes the address, the balance of the address in USD, and the tokens in the address\n */\nexport function usePortfolio(\n  { address, enabled = true }: UsePortfolioProps,\n  _context: RequestContextType = RequestContext.Hook,\n): UseQueryResult<Portfolio> {\n  return useQuery({\n    queryKey: ['usePortfolio', address],\n    queryFn: async () => {\n      const addressWithType = address as Address; // Safe to coerce to Address because useQuery's enabled flag will prevent the query from running if address is undefined\n      const response = await getPortfolios(\n        {\n          addresses: [addressWithType],\n        },\n        _context,\n      );\n\n      if (isApiError(response)) {\n        throw new Error(response.message);\n      }\n\n      if (response.portfolios.length === 0) {\n        return {\n          address: addressWithType,\n          portfolioBalanceInUsd: 0,\n          tokenBalances: [],\n        };\n      }\n\n      return response.portfolios[0];\n    },\n    retry: false,\n    enabled: !!address && enabled,\n    refetchOnWindowFocus: true, // refresh on window focus\n    staleTime: 1000 * 60 * 5, // refresh on mount every 5 minutes\n    refetchOnMount: true,\n    refetchInterval: 1000 * 60 * 15, // refresh in background every 15 minutes\n    refetchIntervalInBackground: true,\n  });\n}\n"],"names":["usePortfolio","address","enabled","_context","RequestContext","Hook","useQuery","queryKey","queryFn","addressWithType","response","getPortfolios","addresses","isApiError","Error","message","portfolios","length","portfolioBalanceInUsd","tokenBalances","retry","refetchOnWindowFocus","staleTime","refetchOnMount","refetchInterval","refetchIntervalInBackground"],"mappings":";;;;AAgBO,SAASA,aACd;AAAA,EAAEC;AAAAA,EAASC,UAAU;AAAwB,GAC7CC,WAA+BC,eAAeC,MACnB;AAC3B,SAAOC,SAAS;AAAA,IACdC,UAAU,CAAC,gBAAgBN,OAAO;AAAA,IAClCO,SAAS,YAAY;AACnB,YAAMC,kBAAkBR;AAClBS,YAAAA,WAAW,MAAMC,cACrB;AAAA,QACEC,WAAW,CAACH,eAAe;AAAA,SAE7BN,QACF;AAEIU,UAAAA,WAAWH,QAAQ,GAAG;AAClB,cAAA,IAAII,MAAMJ,SAASK,OAAO;AAAA,MAAA;AAG9BL,UAAAA,SAASM,WAAWC,WAAW,GAAG;AAC7B,eAAA;AAAA,UACLhB,SAASQ;AAAAA,UACTS,uBAAuB;AAAA,UACvBC,eAAe,CAAA;AAAA,QACjB;AAAA,MAAA;AAGKT,aAAAA,SAASM,WAAW,CAAC;AAAA,IAC9B;AAAA,IACAI,OAAO;AAAA,IACPlB,SAAS,CAAC,CAACD,WAAWC;AAAAA,IACtBmB,sBAAsB;AAAA;AAAA,IACtBC,WAAW,MAAO,KAAK;AAAA;AAAA,IACvBC,gBAAgB;AAAA,IAChBC,iBAAiB,MAAO,KAAK;AAAA;AAAA,IAC7BC,6BAA6B;AAAA,EAAA,CAC9B;AACH;"}