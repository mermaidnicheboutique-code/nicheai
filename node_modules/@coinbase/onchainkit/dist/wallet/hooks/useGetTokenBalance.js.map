{"version":3,"file":"useGetTokenBalance.js","sources":["../../../src/wallet/hooks/useGetTokenBalance.ts"],"sourcesContent":["import { useMemo } from 'react';\nimport { erc20Abi, formatUnits } from 'viem';\nimport type { Address } from 'viem';\nimport { useReadContract } from 'wagmi';\nimport type { UseReadContractReturnType } from 'wagmi';\nimport { getRoundedAmount } from '../../internal/utils/getRoundedAmount';\nimport type { SwapError } from '../../swap';\nimport { getSwapErrorCode } from '../../swap/utils/getSwapErrorCode';\nimport type { Token } from '../../token';\n\nexport type UseGetTokenBalanceResponse = {\n  error?: SwapError;\n  response?: UseReadContractReturnType;\n  convertedBalance?: string;\n  roundedBalance?: string;\n  status: UseReadContractReturnType['status'];\n  refetch: UseReadContractReturnType['refetch'];\n};\n\n/**\n * A custom hook that retrieves and formats the balance of an ERC-20 token for a given address.\n *\n * This hook uses `wagmi`'s `useReadContract` to call the `balanceOf` function on the token contract,\n * and returns both the raw and rounded token balance. It also handles loading, error, and refetch states.\n *\n * @param address - The wallet address whose token balance is being fetched.\n * @param token - The ERC-20 token object containing the token's address and decimals.\n *\n * @returns An object containing:\n * - `convertedBalance`: The full precision balance formatted using the token's decimals.\n * - `roundedBalance`: The balance rounded to 8 decimal places for display purposes.\n * - `status`: The status of the balance fetch operation (`idle`, `loading`, `success`, or `error`).\n * - `error`: A `SwapError` object if an error occurred while fetching the balance.\n * - `response`: The original `useReadContract` response from `wagmi`.\n * - `refetch`: A function to manually re-trigger the balance fetch.\n */\n\nexport function useGetTokenBalance(\n  address?: Address,\n  token?: Token,\n): UseGetTokenBalanceResponse {\n  const tokenBalanceResponse: UseReadContractReturnType = useReadContract({\n    abi: erc20Abi,\n    address: token?.address as Address,\n    functionName: 'balanceOf',\n    args: address ? [address] : [],\n    query: {\n      enabled: !!token?.address && !!address,\n    },\n  });\n\n  return useMemo(() => {\n    let error: SwapError | undefined;\n    if (tokenBalanceResponse?.error) {\n      error = {\n        code: getSwapErrorCode('balance'),\n        error: tokenBalanceResponse?.error?.shortMessage,\n        message: '',\n      };\n    }\n    if (\n      (tokenBalanceResponse?.data !== 0n && !tokenBalanceResponse?.data) ||\n      !token\n    ) {\n      return {\n        convertedBalance: '',\n        status: tokenBalanceResponse.status,\n        error,\n        roundedBalance: '',\n        response: tokenBalanceResponse,\n        refetch: tokenBalanceResponse.refetch,\n      };\n    }\n    const convertedBalance = formatUnits(\n      tokenBalanceResponse?.data as bigint,\n      token?.decimals,\n    );\n    return {\n      convertedBalance,\n      status: tokenBalanceResponse.status,\n      error,\n      response: tokenBalanceResponse,\n      roundedBalance: getRoundedAmount(convertedBalance, 8),\n      refetch: tokenBalanceResponse.refetch,\n    };\n  }, [token, tokenBalanceResponse]);\n}\n"],"names":["useGetTokenBalance","address","token","tokenBalanceResponse","useReadContract","abi","erc20Abi","functionName","args","query","enabled","useMemo","error","code","getSwapErrorCode","shortMessage","message","data","convertedBalance","status","roundedBalance","response","refetch","formatUnits","decimals","getRoundedAmount"],"mappings":";;;;;AAqCgBA,SAAAA,mBACdC,SACAC,OAC4B;AAC5B,QAAMC,uBAAkDC,gBAAgB;AAAA,IACtEC,KAAKC;AAAAA,IACLL,SAASC,+BAAOD;AAAAA,IAChBM,cAAc;AAAA,IACdC,MAAMP,UAAU,CAACA,OAAO,IAAI,CAAE;AAAA,IAC9BQ,OAAO;AAAA,MACLC,SAAS,CAAC,EAACR,+BAAOD,YAAW,CAAC,CAACA;AAAAA,IAAAA;AAAAA,EACjC,CACD;AAED,SAAOU,QAAQ,MAAM;;AACfC,QAAAA;AACJ,QAAIT,6DAAsBS,OAAO;AACvB,cAAA;AAAA,QACNC,MAAMC,iBAAiB,SAAS;AAAA,QAChCF,QAAOT,kEAAsBS,UAAtBT,mBAA6BY;AAAAA,QACpCC,SAAS;AAAA,MACX;AAAA,IAAA;AAEF,SACGb,6DAAsBc,UAAS,MAAM,EAACd,6DAAsBc,SAC7D,CAACf,OACD;AACO,aAAA;AAAA,QACLgB,kBAAkB;AAAA,QAClBC,QAAQhB,qBAAqBgB;AAAAA,QAC7BP;AAAAA,QACAQ,gBAAgB;AAAA,QAChBC,UAAUlB;AAAAA,QACVmB,SAASnB,qBAAqBmB;AAAAA,MAChC;AAAA,IAAA;AAEF,UAAMJ,mBAAmBK,YACvBpB,6DAAsBc,MACtBf,+BAAOsB,QACT;AACO,WAAA;AAAA,MACLN;AAAAA,MACAC,QAAQhB,qBAAqBgB;AAAAA,MAC7BP;AAAAA,MACAS,UAAUlB;AAAAA,MACViB,gBAAgBK,iBAAiBP,kBAAkB,CAAC;AAAA,MACpDI,SAASnB,qBAAqBmB;AAAAA,IAChC;AAAA,EAAA,GACC,CAACpB,OAAOC,oBAAoB,CAAC;AAClC;"}