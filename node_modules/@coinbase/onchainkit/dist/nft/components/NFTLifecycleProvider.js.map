{"version":3,"file":"NFTLifecycleProvider.js","sources":["../../../src/nft/components/NFTLifecycleProvider.tsx"],"sourcesContent":["import { useLifecycleStatus } from '@/internal/hooks/useLifecycleStatus';\nimport { useValue } from '@/internal/hooks/useValue';\nimport { createContext, useContext, useEffect } from 'react';\nimport type {\n  LifecycleStatus,\n  NFTLifecycleContextType,\n  NFTLifecycleProviderProps,\n} from '../types';\n\nconst emptyContext = {} as NFTLifecycleContextType;\n\nexport const NFTLifecycleContext =\n  createContext<NFTLifecycleContextType>(emptyContext);\n\nexport function useNFTLifecycleContext() {\n  const context = useContext(NFTLifecycleContext);\n  if (context === emptyContext) {\n    throw new Error(\n      'useNFTLifecycleContext must be used within an NFTView or NFTMint component',\n    );\n  }\n  return context;\n}\n\nexport function NFTLifecycleProvider({\n  type,\n  onStatus,\n  onError,\n  onSuccess,\n  children,\n}: NFTLifecycleProviderProps) {\n  const [lifecycleStatus, updateLifecycleStatus] =\n    useLifecycleStatus<LifecycleStatus>({\n      statusName: 'init',\n      statusData: null,\n    }); // Component lifecycle\n\n  // Component lifecycle emitters\n  useEffect(() => {\n    // Error\n    if (lifecycleStatus.statusName === 'error') {\n      onError?.(lifecycleStatus.statusData);\n    }\n    // Success\n    if (lifecycleStatus.statusName === 'success') {\n      onSuccess?.(lifecycleStatus.statusData?.transactionReceipts?.[0]);\n    }\n    // Emit Status\n    onStatus?.(lifecycleStatus);\n  }, [\n    onError,\n    onStatus,\n    onSuccess,\n    lifecycleStatus,\n    lifecycleStatus.statusData, // Keep statusData, so that the effect runs when it changes\n    lifecycleStatus.statusName, // Keep statusName, so that the effect runs when it changes\n  ]);\n\n  const value = useValue({\n    lifecycleStatus,\n    type,\n    updateLifecycleStatus,\n  });\n\n  return (\n    <NFTLifecycleContext.Provider value={value}>\n      {children}\n    </NFTLifecycleContext.Provider>\n  );\n}\n"],"names":["emptyContext","NFTLifecycleContext","createContext","useNFTLifecycleContext","context","useContext","Error","NFTLifecycleProvider","type","onStatus","onError","onSuccess","children","lifecycleStatus","updateLifecycleStatus","useLifecycleStatus","statusName","statusData","useEffect","transactionReceipts","value","useValue"],"mappings":";;;;AASA,MAAMA,eAAe,CAAC;AAETC,MAAAA,sBACXC,cAAuCF,YAAY;AAE9C,SAASG,yBAAyB;AACjCC,QAAAA,UAAUC,WAAWJ,mBAAmB;AAC9C,MAAIG,YAAYJ,cAAc;AACtB,UAAA,IAAIM,MACR,4EACF;AAAA,EAAA;AAEKF,SAAAA;AACT;AAEO,SAASG,qBAAqB;AAAA,EACnCC;AAAAA,EACAC;AAAAA,EACAC;AAAAA,EACAC;AAAAA,EACAC;AACyB,GAAG;AAC5B,QAAM,CAACC,iBAAiBC,qBAAqB,IAC3CC,mBAAoC;AAAA,IAClCC,YAAY;AAAA,IACZC,YAAY;AAAA,EAAA,CACb;AAGHC,YAAU,MAAM;;AAEVL,QAAAA,gBAAgBG,eAAe,SAAS;AAC1CN,yCAAUG,gBAAgBI;AAAAA,IAAU;AAGlCJ,QAAAA,gBAAgBG,eAAe,WAAW;AAC5CL,8CAAYE,2BAAgBI,eAAhBJ,mBAA4BM,wBAA5BN,mBAAkD;AAAA,IAAE;AAGlEJ,yCAAWI;AAAAA,EAAe,GACzB;AAAA,IACDH;AAAAA,IACAD;AAAAA,IACAE;AAAAA,IACAE;AAAAA,IACAA,gBAAgBI;AAAAA;AAAAA,IAChBJ,gBAAgBG;AAAAA;AAAAA,EAAAA,CACjB;AAED,QAAMI,QAAQC,SAAS;AAAA,IACrBR;AAAAA,IACAL;AAAAA,IACAM;AAAAA,EAAAA,CACD;AAED,SACG,oBAAA,oBAAoB,UAApB,EAA6B,OAC3BF,SACH,CAAA;AAEJ;"}