import { jsxs, jsx } from "react/jsx-runtime";
import { useNFTContext } from "../NFTProvider.js";
import { useRef, useState, useEffect, useCallback } from "react";
import { cn } from "../../../styles/theme.js";
function NFTAudio({
  className,
  onLoading,
  onLoaded,
  onError
}) {
  const {
    animationUrl
  } = useNFTContext();
  const audioRef = useRef(null);
  const [isPlaying, setIsPlaying] = useState(false);
  useEffect(() => {
    function onEnded() {
      setIsPlaying(false);
    }
    if (animationUrl && (audioRef == null ? void 0 : audioRef.current)) {
      audioRef.current.onloadstart = () => {
        onLoading == null ? void 0 : onLoading(animationUrl);
      };
      audioRef.current.onloadeddata = () => {
        onLoaded == null ? void 0 : onLoaded();
      };
      audioRef.current.addEventListener("ended", onEnded);
      audioRef.current.onerror = (error) => {
        onError == null ? void 0 : onError({
          error: typeof error === "string" ? error : error.type,
          code: "NmNAc01",
          // NFT module NFTAudio component 01 error
          message: "Error loading audio"
        });
      };
    }
  }, [animationUrl, onLoading, onLoaded, onError]);
  const handlePlayPause = useCallback((event) => {
    var _a, _b;
    event.stopPropagation();
    if (isPlaying) {
      (_a = audioRef.current) == null ? void 0 : _a.pause();
      setIsPlaying(false);
    } else {
      (_b = audioRef.current) == null ? void 0 : _b.play();
      setIsPlaying(true);
    }
  }, [isPlaying]);
  if (!animationUrl) {
    return null;
  }
  return /* @__PURE__ */ jsxs("div", { className: cn("ock:max-h-350 ock:w-350 ock:max-w-350", className), children: [
    /* @__PURE__ */ jsx("button", { type: "button", className: cn("ock:bg-ock-background-reverse", "ock:ml-6 ock:inline-flex ock:h-[42px] ock:w-[42px] ock:cursor-pointer ock:items-center ock:justify-center ock:rounded-full"), onClick: handlePlayPause, children: /* @__PURE__ */ jsx("div", { className: cn("ock:ml-px ock:box-border ock:h-[18px] ock:transition-all ock:ease-[100ms] ock:will-change-[border-width]", "ock:border-ock-background-reverse ock:border-l-ock-background", {
      "border-[length:0_0_0_16px] border-double": isPlaying,
      "-mr-px border-[length:9px_0_9px_16px] border-solid": !isPlaying
    }) }) }),
    /* @__PURE__ */ jsx("audio", { ref: audioRef, "data-testid": "ockNFTAudio", autoPlay: false, controls: false, src: animationUrl, children: /* @__PURE__ */ jsx("track", { kind: "captions" }) })
  ] });
}
export {
  NFTAudio
};
//# sourceMappingURL=NFTAudio.js.map
