{"version":3,"file":"NFTMedia.js","sources":["../../../../src/nft/components/view/NFTMedia.tsx"],"sourcesContent":["import type { NFTError } from '@/api/types';\nimport { useNFTLifecycleContext } from '@/nft/components/NFTLifecycleProvider';\nimport { useNFTContext } from '@/nft/components/NFTProvider';\nimport { MediaType, Lifecycle } from '@/nft/types';\nimport { useCallback, useMemo } from 'react';\nimport { cn } from '../../../styles/theme';\nimport { NFTAudio } from './NFTAudio';\nimport { NFTImage } from './NFTImage';\nimport { NFTVideo } from './NFTVideo';\n\ntype NFTMediaProps = {\n  className?: string;\n  square?: boolean;\n};\n\nexport function NFTMedia({ className, square }: NFTMediaProps) {\n  const { mimeType } = useNFTContext();\n  const { type, updateLifecycleStatus } = useNFTLifecycleContext();\n\n  const mediaType = useMemo(() => {\n    if (mimeType?.startsWith('video')) {\n      return MediaType.Video;\n    }\n    if (mimeType?.startsWith('audio')) {\n      return MediaType.Audio;\n    }\n    if (mimeType?.startsWith('image')) {\n      return MediaType.Image;\n    }\n    return MediaType.Unknown;\n  }, [mimeType]);\n\n  const handleLoading = useCallback(\n    (mediaUrl: string) => {\n      updateLifecycleStatus({\n        statusName: 'mediaLoading',\n        statusData: {\n          mediaType,\n          mediaUrl,\n        },\n      });\n    },\n    [mediaType, updateLifecycleStatus],\n  );\n\n  const handleLoaded = useCallback(() => {\n    // for Views, this is the success state\n    updateLifecycleStatus({\n      statusName: type === Lifecycle.MINT ? 'mediaLoaded' : 'success',\n    });\n  }, [type, updateLifecycleStatus]);\n\n  const handleError = useCallback(\n    (error: NFTError) => {\n      updateLifecycleStatus({\n        statusName: 'error',\n        statusData: error,\n      });\n    },\n    [updateLifecycleStatus],\n  );\n\n  const media = useMemo(() => {\n    switch (mediaType) {\n      case MediaType.Video:\n        return (\n          <NFTVideo\n            square={square}\n            onLoading={handleLoading}\n            onLoaded={handleLoaded}\n            onError={handleError}\n          />\n        );\n      case MediaType.Audio:\n        return (\n          <div className=\"relative w-full\">\n            <NFTImage square={square} />\n            <div className=\"absolute bottom-4 mx-auto w-full\">\n              <NFTAudio />\n            </div>\n          </div>\n        );\n      default:\n        // fallback to image\n        return (\n          <NFTImage\n            square={square}\n            onLoading={handleLoading}\n            onLoaded={handleLoaded}\n            onError={handleError}\n          />\n        );\n    }\n  }, [handleError, handleLoaded, handleLoading, mediaType, square]);\n\n  return <div className={cn('pb-2', className)}>{media}</div>;\n}\n"],"names":["NFTMedia","className","square","mimeType","useNFTContext","type","updateLifecycleStatus","useNFTLifecycleContext","mediaType","useMemo","startsWith","MediaType","Video","Audio","Image","Unknown","handleLoading","useCallback","mediaUrl","statusName","statusData","handleLoaded","Lifecycle","MINT","handleError","error","media","cn"],"mappings":";;;;;;;;;AAeO,SAASA,SAAS;AAAA,EAAEC;AAAAA,EAAWC;AAAsB,GAAG;AACvD,QAAA;AAAA,IAAEC;AAAAA,MAAaC,cAAc;AAC7B,QAAA;AAAA,IAAEC;AAAAA,IAAMC;AAAAA,MAA0BC,uBAAuB;AAEzDC,QAAAA,YAAYC,QAAQ,MAAM;AAC1BN,QAAAA,qCAAUO,WAAW,UAAU;AACjC,aAAOC,UAAUC;AAAAA,IAAAA;AAEfT,QAAAA,qCAAUO,WAAW,UAAU;AACjC,aAAOC,UAAUE;AAAAA,IAAAA;AAEfV,QAAAA,qCAAUO,WAAW,UAAU;AACjC,aAAOC,UAAUG;AAAAA,IAAAA;AAEnB,WAAOH,UAAUI;AAAAA,EAAAA,GAChB,CAACZ,QAAQ,CAAC;AAEPa,QAAAA,gBAAgBC,YACpB,CAACC,aAAqB;AACE,0BAAA;AAAA,MACpBC,YAAY;AAAA,MACZC,YAAY;AAAA,QACVZ;AAAAA,QACAU;AAAAA,MAAAA;AAAAA,IACF,CACD;AAAA,EAAA,GAEH,CAACV,WAAWF,qBAAqB,CACnC;AAEMe,QAAAA,eAAeJ,YAAY,MAAM;AAEf,0BAAA;AAAA,MACpBE,YAAYd,SAASiB,UAAUC,OAAO,gBAAgB;AAAA,IAAA,CACvD;AAAA,EAAA,GACA,CAAClB,MAAMC,qBAAqB,CAAC;AAE1BkB,QAAAA,cAAcP,YAClB,CAACQ,UAAoB;AACG,0BAAA;AAAA,MACpBN,YAAY;AAAA,MACZC,YAAYK;AAAAA,IAAAA,CACb;AAAA,EAAA,GAEH,CAACnB,qBAAqB,CACxB;AAEMoB,QAAAA,QAAQjB,QAAQ,MAAM;AAC1B,YAAQD,WAAS;AAAA,MACf,KAAKG,UAAUC;AAEX,eAAA,oBAAC,YACC,QACA,WAAWI,eACX,UAAUK,cACV,SAASG,aACT;AAAA,MAEN,KAAKb,UAAUE;AAEX,eAAA,qBAAC,OAAI,EAAA,WAAU,2BACb,UAAA;AAAA,UAAA,oBAAC,YAAS,QAAe;AAAA,8BACxB,OAAI,EAAA,WAAU,oDACb,UAAA,oBAAC,YAAQ,EACX,CAAA;AAAA,QAAA,GACF;AAAA,MAEJ;AAGI,eAAA,oBAAC,YACC,QACA,WAAWG,eACX,UAAUK,cACV,SAASG,aACT;AAAA,IAAA;AAAA,EAER,GACC,CAACA,aAAaH,cAAcL,eAAeR,WAAWN,MAAM,CAAC;AAEhE,6BAAQ,OAAI,EAAA,WAAWyB,GAAE,YAAS1B,SAAS,GAAIyB,UAAM,OAAA;AACvD;"}