{"version":3,"file":"NFTImage.js","sources":["../../../../src/nft/components/view/NFTImage.tsx"],"sourcesContent":["import type { NFTError } from '@/api/types';\nimport { useNFTContext } from '@/nft/components/NFTProvider';\nimport { type MouseEvent, useCallback, useEffect, useState } from 'react';\nimport { defaultNFTSvg } from '../../../internal/svg/defaultNFTSvg';\nimport { cn } from '../../../styles/theme';\n\ntype NFTImageProps = {\n  className?: string;\n  square?: boolean;\n  onLoading?: (mediaUrl: string) => void;\n  onLoaded?: () => void;\n  onError?: (error: NFTError) => void;\n};\n\nexport function NFTImage({\n  className,\n  square = true,\n  onLoading,\n  onLoaded,\n  onError,\n}: NFTImageProps) {\n  const { imageUrl, description } = useNFTContext();\n  const [loaded, setLoaded] = useState(false);\n  const [error, setError] = useState(false);\n\n  const loadImage = useCallback(() => {\n    if (imageUrl) {\n      onLoading?.(imageUrl);\n\n      const img = new Image();\n      img.onload = () => {\n        setLoaded(true);\n        onLoaded?.();\n      };\n\n      img.onerror = (error: string | Event) => {\n        onError?.({\n          error: typeof error === 'string' ? error : error.type,\n          code: 'NmNIc01', // NFT module NFTImage component 01 error\n          message: 'Error loading image',\n        });\n        setError(true);\n      };\n      img.src = imageUrl;\n    }\n  }, [imageUrl, onLoading, onLoaded, onError]);\n\n  useEffect(() => {\n    loadImage();\n  }, [loadImage]);\n\n  const handleRetry = useCallback(\n    async (e: MouseEvent) => {\n      e.stopPropagation();\n      setError(false);\n      loadImage();\n    },\n    [loadImage],\n  );\n\n  return (\n    <div\n      className={cn(\n        'grid w-full',\n        '[&>*]:col-start-1 [&>*]:col-end-1 [&>*]:row-start-1 [&>*]:row-end-1',\n        { 'aspect-square': square },\n        className,\n      )}\n    >\n      <div className=\"flex items-center justify-center\">{defaultNFTSvg}</div>\n      <div\n        className={cn(\n          'grid h-full w-full content-center justify-center overflow-hidden',\n          { 'aspect-square': square },\n        )}\n      >\n        <img\n          data-testid=\"ockNFTImage\"\n          src={imageUrl}\n          alt={description}\n          decoding=\"async\"\n          className={cn(\n            'transition-opacity duration-500 ease-in-out',\n            loaded ? 'opacity-100' : 'opacity-0',\n            { 'h-full w-full object-cover': square },\n          )}\n        />\n      </div>\n      {error && (\n        <div className=\"flex items-center justify-center\">\n          <button type=\"button\" onClick={handleRetry} className=\"z-10 mt-[60%]\">\n            retry\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["NFTImage","className","square","onLoading","onLoaded","onError","imageUrl","description","useNFTContext","loaded","setLoaded","useState","error","setError","loadImage","useCallback","img","Image","onload","onerror","type","code","message","src","useEffect","handleRetry","e","stopPropagation","cn","defaultNFTSvg"],"mappings":";;;;;AAcO,SAASA,SAAS;AAAA,EACvBC;AAAAA,EACAC,SAAS;AAAA,EACTC;AAAAA,EACAC;AAAAA,EACAC;AACa,GAAG;AACV,QAAA;AAAA,IAAEC;AAAAA,IAAUC;AAAAA,MAAgBC,cAAc;AAChD,QAAM,CAACC,QAAQC,SAAS,IAAIC,SAAS,KAAK;AAC1C,QAAM,CAACC,OAAOC,QAAQ,IAAIF,SAAS,KAAK;AAElCG,QAAAA,YAAYC,YAAY,MAAM;AAClC,QAAIT,UAAU;AACZH,6CAAYG;AAENU,YAAAA,MAAM,IAAIC,MAAM;AACtBD,UAAIE,SAAS,MAAM;AACjBR,kBAAU,IAAI;AACH;AAAA,MACb;AAEIS,UAAAA,UAAU,CAACP,WAA0B;AAC7B,2CAAA;AAAA,UACRA,OAAO,OAAOA,WAAU,WAAWA,SAAQA,OAAMQ;AAAAA,UACjDC,MAAM;AAAA;AAAA,UACNC,SAAS;AAAA,QAAA;AAEXT,iBAAS,IAAI;AAAA,MACf;AACAG,UAAIO,MAAMjB;AAAAA,IAAAA;AAAAA,KAEX,CAACA,UAAUH,WAAWC,UAAUC,OAAO,CAAC;AAE3CmB,YAAU,MAAM;AACJ,cAAA;AAAA,EAAA,GACT,CAACV,SAAS,CAAC;AAERW,QAAAA,cAAcV,YAClB,OAAOW,MAAkB;AACvBA,MAAEC,gBAAgB;AAClBd,aAAS,KAAK;AACJ,cAAA;AAAA,EAAA,GAEZ,CAACC,SAAS,CACZ;AAEA,SACG,qBAAA,OAAA,EACC,WAAWc,GAGT,uBAAA,uFAAA;AAAA,IAAE,iBAAiB1B;AAAAA,EAAAA,GACnBD,SACF,GAEA,UAAA;AAAA,IAAC,oBAAA,OAAA,EAAI,WAAU,gDAAoC4B,UAAc,eAAA;AAAA,IAChE,oBAAA,OAAA,EACC,WAAWD,GAET,4FAAA;AAAA,MAAE,iBAAiB1B;AAAAA,IAAAA,CACrB,GAEA,UAAA,oBAAC,OACC,EAAA,eAAY,eACZ,KAAKI,UACL,KAAKC,aACL,UAAS,SACT,WAAWqB,GAETnB,2DAAAA,8CACA;AAAA,MAAE,8BAA8BP;AAAAA,IAAAA,CAClC,GAAE,EAEN,CAAA;AAAA,IACCU,SACC,oBAAC,OAAI,EAAA,WAAU,gDACb,UAAC,oBAAA,UAAA,EAAO,MAAK,UAAS,SAASa,aAAa,WAAU,yBAAe,mBAErE,EACF,CAAA;AAAA,EAAA,GAEJ;AAEJ;"}