import { jsxs, jsx } from "react/jsx-runtime";
import { useNFTContext } from "../NFTProvider.js";
import { useState, useCallback, useEffect } from "react";
import { defaultNFTSvg } from "../../../internal/svg/defaultNFTSvg.js";
import { cn } from "../../../styles/theme.js";
function NFTImage({
  className,
  square = true,
  onLoading,
  onLoaded,
  onError
}) {
  const {
    imageUrl,
    description
  } = useNFTContext();
  const [loaded, setLoaded] = useState(false);
  const [error, setError] = useState(false);
  const loadImage = useCallback(() => {
    if (imageUrl) {
      onLoading == null ? void 0 : onLoading(imageUrl);
      const img = new Image();
      img.onload = () => {
        setLoaded(true);
        onLoaded == null ? void 0 : onLoaded();
      };
      img.onerror = (error2) => {
        onError == null ? void 0 : onError({
          error: typeof error2 === "string" ? error2 : error2.type,
          code: "NmNIc01",
          // NFT module NFTImage component 01 error
          message: "Error loading image"
        });
        setError(true);
      };
      img.src = imageUrl;
    }
  }, [imageUrl, onLoading, onLoaded, onError]);
  useEffect(() => {
    loadImage();
  }, [loadImage]);
  const handleRetry = useCallback(async (e) => {
    e.stopPropagation();
    setError(false);
    loadImage();
  }, [loadImage]);
  return /* @__PURE__ */ jsxs("div", { className: cn("ock:grid ock:w-full", "ock:[&>*]:col-start-1 ock:[&>*]:col-end-1 ock:[&>*]:row-start-1 ock:[&>*]:row-end-1", {
    "aspect-square": square
  }, className), children: [
    /* @__PURE__ */ jsx("div", { className: "ock:flex ock:items-center ock:justify-center", children: defaultNFTSvg }),
    /* @__PURE__ */ jsx("div", { className: cn("ock:grid ock:h-full ock:w-full ock:content-center ock:justify-center ock:overflow-hidden", {
      "aspect-square": square
    }), children: /* @__PURE__ */ jsx("img", { "data-testid": "ockNFTImage", src: imageUrl, alt: description, decoding: "async", className: cn("ock:transition-opacity ock:duration-500 ock:ease-in-out", loaded ? "ock:opacity-100" : "ock:opacity-0", {
      "h-full w-full object-cover": square
    }) }) }),
    error && /* @__PURE__ */ jsx("div", { className: "ock:flex ock:items-center ock:justify-center", children: /* @__PURE__ */ jsx("button", { type: "button", onClick: handleRetry, className: "ock:z-10 ock:mt-[60%]", children: "retry" }) })
  ] });
}
export {
  NFTImage
};
//# sourceMappingURL=NFTImage.js.map
