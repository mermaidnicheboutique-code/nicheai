{"version":3,"file":"Avatar.js","sources":["../../../src/identity/components/Avatar.tsx"],"sourcesContent":["'use client';\nimport { useIdentityContext } from '@/identity/components/IdentityProvider';\nimport { useAvatar } from '@/identity/hooks/useAvatar';\nimport { useName } from '@/identity/hooks/useName';\nimport type { AvatarProps } from '@/identity/types';\nimport { findComponent } from '@/internal/utils/findComponent';\nimport { Children, ImgHTMLAttributes, ReactNode, useMemo } from 'react';\nimport { defaultAvatarSVG } from '../../internal/svg/defaultAvatarSVG';\nimport { defaultLoadingSVG } from '../../internal/svg/defaultLoadingSVG';\nimport { cn } from '../../styles/theme';\nimport { Badge } from './Badge';\nimport { DisplayBadge } from './DisplayBadge';\nimport { Address } from 'viem';\n\n/**\n * Represents an Avatar component that displays either a loading indicator,\n * a default avatar, or a custom avatar based on Ethereum Name Service (ENS).\n */\nexport function Avatar({\n  address = null,\n  chain,\n  className,\n  defaultComponent,\n  loadingComponent,\n  children,\n  ...props\n}: AvatarProps) {\n  const { address: contextAddress } = useIdentityContext();\n  const accountAddress = address ?? contextAddress;\n\n  if (!accountAddress) {\n    console.error(\n      'Avatar: an Ethereum address must be provided to the Identity or Avatar component.',\n    );\n    return null;\n  }\n\n  return (\n    <AvatarContent\n      address={address}\n      chain={chain}\n      className={className}\n      defaultComponent={defaultComponent}\n      loadingComponent={loadingComponent}\n      {...props}\n    >\n      {children}\n    </AvatarContent>\n  );\n}\n\nfunction AvatarContent({\n  address = null,\n  chain,\n  className,\n  defaultComponent,\n  loadingComponent,\n  children,\n  name: nameOverride,\n  avatar: avatarOverride,\n  ...props\n}: AvatarProps) {\n  const { address: contextAddress, chain: contextChain } = useIdentityContext();\n\n  const accountAddress = address ?? contextAddress;\n  const accountChain = chain ?? contextChain;\n\n  const { data: name, isLoading: isLoadingName } = useName({\n    address: accountAddress,\n    chain: accountChain,\n  });\n\n  const { data: avatar, isLoading: isLoadingAvatar } = useAvatar(\n    { ensName: name ?? '', chain: accountChain },\n    { enabled: !!name },\n  );\n\n  const { resolvedName, resolvedAvatar } = useMemo(() => {\n    return {\n      resolvedName: nameOverride ?? name ?? '',\n      resolvedAvatar: avatarOverride ?? avatar ?? '',\n    };\n  }, [name, avatar, nameOverride, avatarOverride]);\n\n  const badge = useMemo(() => {\n    return Children.toArray(children).find(findComponent(Badge));\n  }, [children]);\n\n  const defaultAvatar = defaultComponent || defaultAvatarSVG;\n  const loadingAvatar = loadingComponent || defaultLoadingSVG;\n\n  if (isLoadingName || isLoadingAvatar) {\n    return (\n      <div className={cn('h-8 w-8 overflow-hidden rounded-full', className)}>\n        {loadingAvatar}\n      </div>\n    );\n  }\n\n  return (\n    <AvatarRenderer\n      avatar={resolvedAvatar}\n      name={resolvedName}\n      defaultAvatar={defaultAvatar}\n      badge={badge}\n      accountAddress={accountAddress}\n      className={className}\n      {...props}\n    />\n  );\n}\n\nfunction AvatarRenderer({\n  className,\n  avatar,\n  name,\n  defaultAvatar,\n  badge,\n  accountAddress,\n  ...rest\n}: {\n  className?: string;\n  avatar: string;\n  name: string;\n  defaultAvatar: ReactNode;\n  badge: ReactNode;\n  accountAddress: Address;\n} & ImgHTMLAttributes<HTMLImageElement>) {\n  return (\n    <div className=\"relative\">\n      <div\n        data-testid=\"ockAvatar_ImageContainer\"\n        className={cn('h-10 w-10 overflow-hidden rounded-full', className)}\n      >\n        {name && avatar ? (\n          <img\n            className=\"min-h-full min-w-full object-cover\"\n            data-testid=\"ockAvatar_Image\"\n            loading=\"lazy\"\n            width=\"100%\"\n            height=\"100%\"\n            decoding=\"async\"\n            src={avatar}\n            alt={name}\n            {...rest}\n          />\n        ) : (\n          <div className={cn('border-ock-background', 'h-full w-full border')}>\n            {defaultAvatar}\n          </div>\n        )}\n      </div>\n      {badge && (\n        <DisplayBadge address={accountAddress}>\n          <div\n            data-testid=\"ockAvatar_BadgeContainer\"\n            className=\"-bottom-0.5 -right-0.5 absolute flex h-[15px] w-[15px] items-center justify-center rounded-full bg-transparent\"\n          >\n            <div className=\"flex h-3 w-3 items-center justify-center\">\n              {badge}\n            </div>\n          </div>\n        </DisplayBadge>\n      )}\n    </div>\n  );\n}\n"],"names":["Avatar","address","chain","className","defaultComponent","loadingComponent","children","props","contextAddress","useIdentityContext","accountAddress","console","error","AvatarContent","name","nameOverride","avatar","avatarOverride","contextChain","accountChain","data","isLoading","isLoadingName","useName","isLoadingAvatar","useAvatar","ensName","enabled","resolvedName","resolvedAvatar","useMemo","badge","Children","toArray","find","findComponent","Badge","defaultAvatar","defaultAvatarSVG","loadingAvatar","defaultLoadingSVG","cn","AvatarRenderer","rest"],"mappings":"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"}