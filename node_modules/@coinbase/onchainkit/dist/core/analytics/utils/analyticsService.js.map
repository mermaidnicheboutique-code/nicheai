{"version":3,"file":"analyticsService.js","sources":["../../../../src/core/analytics/utils/analyticsService.ts"],"sourcesContent":["import { getOnchainKitConfig } from '@/core/OnchainKitConfig';\nimport { ANALYTICS_API_URL } from '@/core/analytics/constants';\nimport type {\n  AnalyticsEvent,\n  AnalyticsEventData,\n} from '@/core/analytics/types';\nimport { clientMetaManager } from '@/core/clientMeta/clientMetaManager';\n\nimport { JSON_HEADERS } from '@/core/network/constants';\n\nfunction buildBody<T extends AnalyticsEvent>(\n  event: T,\n  data: AnalyticsEventData[T],\n) {\n  return {\n    apiKey: getOnchainKitConfig('apiKey') ?? 'undefined',\n    sessionId: getOnchainKitConfig('sessionId') ?? 'undefined',\n    timestamp: Date.now(),\n    eventType: event,\n    data,\n    origin: window.location.origin,\n  };\n}\n\nasync function handleSendAnalytics<T extends AnalyticsEvent>(\n  event: T,\n  data: AnalyticsEventData[T],\n) {\n  const config = getOnchainKitConfig('config');\n\n  // Don't send analytics if disabled\n  if (!config?.analytics) {\n    return;\n  }\n\n  try {\n    const clientMeta = await clientMetaManager.getClientMeta();\n    await fetch(config?.analyticsUrl ?? ANALYTICS_API_URL, {\n      method: 'POST',\n      headers: {\n        ...JSON_HEADERS,\n        'OnchainKit-App-Name': document.title,\n        'OnchainKit-Client-Fid': clientMeta.clientFid?.toString() ?? '',\n        'OnchainKit-Mode': clientMeta.mode,\n      },\n      body: JSON.stringify(buildBody(event, data)),\n    });\n  } catch (error) {\n    // Silently fail\n    if (process.env.NODE_ENV !== 'production') {\n      console.error('Error sending analytics:', error);\n    }\n  }\n}\n\nexport const sendAnalyticsPayload = <T extends AnalyticsEvent>(\n  event: T,\n  data: AnalyticsEventData[T],\n) => handleSendAnalytics(event, data);\n"],"names":["buildBody","event","data","apiKey","getOnchainKitConfig","sessionId","timestamp","Date","now","eventType","origin","window","location","handleSendAnalytics","config","analytics","clientMeta","clientMetaManager","getClientMeta","fetch","analyticsUrl","ANALYTICS_API_URL","method","headers","JSON_HEADERS","document","title","clientFid","toString","mode","body","JSON","stringify","error","process","env","NODE_ENV","sendAnalyticsPayload"],"mappings":";;;;AAUA,SAASA,UACPC,OACAC,MACA;AACO,SAAA;AAAA,IACLC,QAAQC,oBAAoB,QAAQ,KAAK;AAAA,IACzCC,WAAWD,oBAAoB,WAAW,KAAK;AAAA,IAC/CE,WAAWC,KAAKC,IAAI;AAAA,IACpBC,WAAWR;AAAAA,IACXC;AAAAA,IACAQ,QAAQC,OAAOC,SAASF;AAAAA,EAC1B;AACF;AAEA,eAAeG,oBACbZ,OACAC,MACA;;AACMY,QAAAA,SAASV,oBAAoB,QAAQ;AAGvC,MAAA,EAACU,iCAAQC,YAAW;AACtB;AAAA,EAAA;AAGE,MAAA;AACIC,UAAAA,aAAa,MAAMC,kBAAkBC,cAAc;AACnDC,UAAAA,OAAML,iCAAQM,iBAAgBC,mBAAmB;AAAA,MACrDC,QAAQ;AAAA,MACRC,SAAS;AAAA,QACP,GAAGC;AAAAA,QACH,uBAAuBC,SAASC;AAAAA,QAChC,2BAAyBV,gBAAWW,cAAXX,mBAAsBY,eAAc;AAAA,QAC7D,mBAAmBZ,WAAWa;AAAAA,MAChC;AAAA,MACAC,MAAMC,KAAKC,UAAUhC,UAAUC,OAAOC,IAAI,CAAC;AAAA,IAAA,CAC5C;AAAA,WACM+B,OAAO;AAEVC,QAAAA,QAAQC,IAAIC,aAAa,cAAc;AACjCH,cAAAA,MAAM,4BAA4BA,KAAK;AAAA,IAAA;AAAA,EACjD;AAEJ;AAEO,MAAMI,uBAAuB,CAClCpC,OACAC,SACGW,oBAAoBZ,OAAOC,IAAI;"}