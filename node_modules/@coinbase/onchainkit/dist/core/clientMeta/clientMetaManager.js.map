{"version":3,"file":"clientMetaManager.js","sources":["../../../src/core/clientMeta/clientMetaManager.ts"],"sourcesContent":["import sdk from '@farcaster/miniapp-sdk';\n\nexport type ClientMeta = {\n  mode: 'onchainkit' | 'minikit';\n  clientFid: number | null;\n};\n\nclass ClientMetaManager {\n  public clientMeta: ClientMeta | null = null;\n\n  private initPromise: Promise<ClientMeta> | null = null;\n\n  public async init({ isMiniKit }: { isMiniKit: boolean }) {\n    if (this.isInitialized()) {\n      console.warn('ClientMetaManager already initialized');\n      return;\n    }\n\n    this.initPromise = this.handleInit({ isMiniKit });\n  }\n\n  public isInitialized() {\n    return !!this.initPromise;\n  }\n\n  public async getClientMeta() {\n    if (!this.initPromise) throw new Error('ClientMetaManager not initialized');\n    if (!this.clientMeta) return await this.initPromise;\n    return this.clientMeta;\n  }\n\n  private async handleInit({ isMiniKit }: { isMiniKit: boolean }) {\n    let clientFid: number | null = null;\n\n    try {\n      const context = await sdk.context;\n      clientFid = context?.client?.clientFid || null;\n    } catch (error) {\n      console.error('Error getting client FID', error);\n    }\n\n    this.clientMeta = {\n      mode: isMiniKit ? 'minikit' : 'onchainkit',\n      clientFid,\n    };\n\n    return this.clientMeta;\n  }\n}\n\nexport const clientMetaManager = new ClientMetaManager();\n"],"names":["ClientMetaManager","clientMeta","initPromise","init","isMiniKit","isInitialized","console","warn","handleInit","getClientMeta","Error","clientFid","context","sdk","client","error","mode","clientMetaManager"],"mappings":";AAOA,MAAMA,kBAAkB;AAAA,EAAxB,cAAA;AACE,SAAOC,aAAgC;AAEvC,SAAQC,cAA0C;AAAA,EAAA;AAAA,EAElD,MAAaC,KAAK;AAAA,IAAEC;AAAAA,EAAAA,GAAqC;AACnD,QAAA,KAAKC,iBAAiB;AACxBC,cAAQC,KAAK,uCAAuC;AACpD;AAAA,IAAA;AAGGL,SAAAA,cAAc,KAAKM,WAAW;AAAA,MAAEJ;AAAAA,IAAAA,CAAW;AAAA,EAAA;AAAA,EAG3CC,gBAAgB;AACd,WAAA,CAAC,CAAC,KAAKH;AAAAA,EAAAA;AAAAA,EAGhB,MAAaO,gBAAgB;AAC3B,QAAI,CAAC,KAAKP,YAAmB,OAAA,IAAIQ,MAAM,mCAAmC;AAC1E,QAAI,CAAC,KAAKT,WAAY,QAAO,MAAM,KAAKC;AACxC,WAAO,KAAKD;AAAAA,EAAAA;AAAAA,EAGd,MAAcO,WAAW;AAAA,IAAEJ;AAAAA,EAAAA,GAAqC;;AAC9D,QAAIO,YAA2B;AAE3B,QAAA;AACIC,YAAAA,UAAU,MAAMC,IAAID;AACdA,oBAAAA,wCAASE,WAATF,mBAAiBD,cAAa;AAAA,aACnCI,OAAO;AACNA,cAAAA,MAAM,4BAA4BA,KAAK;AAAA,IAAA;AAGjD,SAAKd,aAAa;AAAA,MAChBe,MAAMZ,YAAY,YAAY;AAAA,MAC9BO;AAAAA,IACF;AAEA,WAAO,KAAKV;AAAAA,EAAAA;AAEhB;AAEagB,MAAAA,oBAAoB,IAAIjB,kBAAkB;"}